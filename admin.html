<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flood Relief Fund | Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --secondary: #34a853;
            --accent: #ea4335;
            --warning: #fbbc05;
            --volunteer: #673ab7;
            --donor: #ff9800;
            --light: #f8f9fa;
            --dark: #202124;
            --gray: #5f6368;
            --light-gray: #e8eaed;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --border-radius: 12px;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Background Animation */
        .background-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.3;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); }
            25% { transform: translateY(-20px) translateX(10px) rotate(90deg); }
            50% { transform: translateY(0) translateX(20px) rotate(180deg); }
            75% { transform: translateY(20px) translateX(10px) rotate(270deg); }
        }

        /* Admin Login Container */
        .admin-login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .admin-login-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 50px 40px;
            width: 100%;
            max-width: 450px;
            transform-style: preserve-3d;
            animation: cardAppear 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: translateY(50px) rotateX(-10deg);
            }
            to {
                opacity: 1;
                transform: translateY(0) rotateX(0);
            }
        }

        .card-decoration {
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: var(--gradient);
            opacity: 0.05;
            transform: rotate(45deg);
            z-index: -1;
            animation: rotateBg 20s linear infinite;
        }

        @keyframes rotateBg {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Logo */
        .login-logo {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .logo-icon {
            width: 70px;
            height: 70px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
            overflow: hidden;
            padding: 5px;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(26, 115, 232, 0.7);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 0 10px rgba(26, 115, 232, 0);
            }
        }

        .logo-icon img {
            width: 70%;
            height: 70%;
            object-fit: contain;
        }

        .logo-text {
            font-size: 2rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-header h1 {
            font-size: 2.2rem;
            color: var(--dark);
            margin-bottom: 10px;
            text-align: center;
            position: relative;
            display: inline-block;
        }

        .login-header h1::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 25%;
            width: 50%;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
            animation: lineGrow 1s ease-out;
        }

        @keyframes lineGrow {
            from { width: 0; left: 50%; }
            to { width: 50%; left: 25%; }
        }

        .login-header p {
            color: var(--gray);
            font-size: 1rem;
            margin-top: 10px;
            text-align: center;
        }

        /* Role Selection Tabs */
        .role-tabs {
            display: flex;
            background: var(--light-gray);
            border-radius: var(--border-radius);
            padding: 5px;
            margin-bottom: 25px;
            position: relative;
        }

        .role-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: transparent;
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            border-radius: 8px;
            transition: var(--transition);
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .role-btn.active {
            color: var(--primary);
        }

        .role-indicator {
            position: absolute;
            top: 5px;
            left: 5px;
            height: calc(100% - 10px);
            width: calc(50% - 10px);
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            z-index: 0;
        }

        /* Form Styles */
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .form-group {
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 500;
            font-size: 0.95rem;
        }

        .form-input-container {
            position: relative;
        }

        .form-input {
            width: 100%;
            padding: 16px 20px 16px 50px;
            border: 2px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 1rem;
            background: white;
            transition: var(--transition);
            outline: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .form-input:focus {
            border-color: var(--primary);
            box-shadow: 0 5px 20px rgba(26, 115, 232, 0.15);
        }

        .input-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
            font-size: 1.2rem;
            transition: var(--transition);
        }

        .form-input:focus + .input-icon {
            color: var(--primary);
        }

        .password-toggle {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.2rem;
            padding: 5px;
        }

        .password-toggle:hover {
            color: var(--primary);
        }

        /* Submit Button */
        .submit-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            box-shadow: 0 5px 20px rgba(26, 115, 232, 0.3);
            width: 100%;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(26, 115, 232, 0.4);
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        /* Loading Animation */
        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .submit-btn.loading .loading-spinner {
            display: block;
        }

        .submit-btn.loading .btn-text {
            display: none;
        }

        /* Dashboard Styles */
        .dashboard-container {
            display: none;
        }

        .dashboard-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 0 30px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .menu-toggle {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
            border-radius: var(--border-radius);
            transition: var(--transition);
            display: none;
        }

        .menu-toggle:hover {
            background: rgba(26, 115, 232, 0.1);
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-title h1 {
            font-size: 1.5rem;
            color: var(--dark);
            font-weight: 600;
        }

        .user-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .notification-bell {
            position: relative;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .notification-bell:hover {
            background: rgba(26, 115, 232, 0.1);
        }

        .notification-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent);
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
            font-weight: 600;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            position: relative;
            padding: 8px 12px;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .user-profile:hover {
            background: rgba(26, 115, 232, 0.1);
        }

        .user-profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            object-fit: cover;
        }

        .profile-info {
            display: flex;
            flex-direction: column;
        }

        .profile-name {
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }

        .profile-role {
            color: var(--gray);
            font-size: 0.8rem;
        }

        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            min-width: 220px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            border-radius: var(--border-radius);
            overflow: hidden;
            display: none;
            z-index: 1000;
            border: 1px solid var(--light-gray);
            margin-top: 10px;
        }

        .user-profile:hover .profile-dropdown {
            display: block;
        }

        .profile-dropdown a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            color: var(--gray);
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.95rem;
        }

        .profile-dropdown a:hover {
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
        }

        .divider {
            height: 1px;
            background: var(--light-gray);
            margin: 5px 0;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            height: calc(100vh - 80px);
            position: fixed;
            top: 80px;
            left: 0;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 999;
            box-shadow: 5px 0 20px rgba(0, 0, 0, 0.05);
        }

        .sidebar-header {
            padding: 30px 25px;
            border-bottom: 1px solid var(--light-gray);
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .sidebar-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-nav ul {
            list-style: none;
            padding: 20px 0;
        }

        .sidebar-nav li a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 25px;
            color: var(--gray);
            text-decoration: none;
            transition: var(--transition);
            position: relative;
            font-size: 0.95rem;
            border-left: 4px solid transparent;
        }

        .sidebar-nav li a:hover {
            background: rgba(26, 115, 232, 0.05);
            color: var(--primary);
        }

        .sidebar-nav li a.active {
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
            border-left: 4px solid var(--primary);
            font-weight: 500;
        }

        .nav-badge {
            margin-left: auto;
            background: var(--accent);
            color: white;
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 10px;
            min-width: 20px;
            text-align: center;
            font-weight: 600;
        }

        .sidebar-footer {
            padding: 25px;
            border-top: 1px solid var(--light-gray);
            margin-top: auto;
            position: sticky;
            bottom: 0;
            background: white;
        }

        .back-to-site {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--gray);
            text-decoration: none;
            padding: 15px;
            border-radius: var(--border-radius);
            transition: var(--transition);
            font-size: 0.95rem;
            background: var(--light);
        }

        .back-to-site:hover {
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 30px;
            background: #f5f7fa;
            min-height: calc(100vh - 80px);
            transition: var(--transition);
            margin-top: 80px;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
        }

        .content-header h2 {
            color: var(--dark);
            font-size: 2rem;
            font-weight: 600;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn-refresh {
            background: white;
            border: 1px solid var(--light-gray);
            padding: 12px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray);
        }

        .btn-refresh:hover {
            background: rgba(26, 115, 232, 0.1);
            border-color: var(--primary);
            color: var(--primary);
        }

        .date-selector input {
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 14px;
            color: var(--gray);
            background: white;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-top: 4px solid var(--primary);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .stat-header h3 {
            font-size: 1rem;
            color: var(--gray);
            font-weight: 500;
        }

        .stat-icon {
            font-size: 24px;
            color: var(--primary);
            background: rgba(26, 115, 232, 0.1);
            padding: 12px;
            border-radius: 10px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
            line-height: 1;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.95rem;
            margin-bottom: 10px;
        }

        .stat-change {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .stat-change.positive {
            background: rgba(52, 168, 83, 0.1);
            color: var(--secondary);
        }

        .stat-change.negative {
            background: rgba(234, 67, 53, 0.1);
            color: var(--accent);
        }

        /* Buttons */
        .btn-primary {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            transition: var(--transition);
            font-size: 0.95rem;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26, 115, 232, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--gray);
            border: 1px solid var(--light-gray);
            padding: 12px 24px;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-size: 0.95rem;
        }

        .btn-secondary:hover {
            background: rgba(26, 115, 232, 0.05);
            border-color: var(--primary);
            color: var(--primary);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--dark);
            color: white;
            padding: 16px 24px;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transform: translateY(20px);
            transition: var(--transition);
            z-index: 2000;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 400px;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success { background: var(--secondary); }
        .toast.error { background: var(--accent); }
        .toast.warning { background: var(--warning); }
        .toast.info { background: var(--primary); }

        /* Tables */
        .table-container {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: #f8f9fa;
            padding: 18px 20px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid var(--light-gray);
            font-size: 0.95rem;
        }

        .data-table td {
            padding: 16px 20px;
            border-bottom: 1px solid var(--light-gray);
            color: var(--gray);
            font-size: 0.95rem;
        }

        .data-table tr:hover {
            background: rgba(26, 115, 232, 0.02);
        }

        .btn-edit {
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
            border: 1px solid rgba(26, 115, 232, 0.2);
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: var(--transition);
        }

        .btn-edit:hover {
            background: rgba(26, 115, 232, 0.2);
        }

        .btn-delete {
            background: rgba(234, 67, 53, 0.1);
            color: var(--accent);
            border: 1px solid rgba(234, 67, 53, 0.2);
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: var(--transition);
        }

        .btn-delete:hover {
            background: rgba(234, 67, 53, 0.2);
        }

        /* Charts */
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .chart-container h3 {
            margin-bottom: 20px;
            color: var(--dark);
            font-size: 1.2rem;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge-success {
            background: rgba(52, 168, 83, 0.1);
            color: var(--secondary);
        }

        .badge-warning {
            background: rgba(251, 188, 5, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(234, 67, 53, 0.1);
            color: var(--accent);
        }

        .badge-info {
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
        }

        /* Gallery Styles */
        .gallery-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 30px;
        }

        .gallery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .gallery-item {
            position: relative;
            border-radius: var(--border-radius);
            overflow: hidden;
            aspect-ratio: 1;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
            border-color: var(--primary);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .gallery-upload-area {
            border: 3px dashed var(--light-gray);
            border-radius: var(--border-radius);
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
            background: var(--light);
        }

        .gallery-upload-area:hover {
            border-color: var(--primary);
            background: rgba(26, 115, 232, 0.05);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-header h3 {
            color: var(--dark);
            font-size: 1.3rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--gray);
            cursor: pointer;
            padding: 5px;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--accent);
            transform: rotate(90deg);
        }

        /* Switch Toggle */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--light-gray);
            transition: var(--transition);
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Image Preview Container */
        .image-preview-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .image-preview {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }

        .image-preview img {
            width: 100%;
            height: 100px;
            object-fit: cover;
        }

        .image-preview-remove {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Notification Items */
        .notification-item {
            padding: 15px;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .notification-item:hover {
            background: rgba(26, 115, 232, 0.05);
        }

        .notification-item.unread {
            background: rgba(26, 115, 232, 0.08);
        }

        /* Editor Styles */
        .editor-toolbar {
            display: flex;
            gap: 5px;
            padding: 10px;
            background: var(--light);
            border-bottom: 1px solid var(--light-gray);
            border-radius: 8px 8px 0 0;
        }

        .editor-toolbar button {
            background: white;
            border: 1px solid var(--light-gray);
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
        }

        .editor-toolbar button:hover {
            background: rgba(26, 115, 232, 0.1);
            border-color: var(--primary);
        }

        .editor-content {
            min-height: 200px;
            padding: 15px;
            border: 1px solid var(--light-gray);
            border-radius: 0 0 8px 8px;
            outline: none;
            background: white;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
            
            .menu-toggle {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .content-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 15px;
            }
            
            .gallery-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        @media (max-width: 576px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-login-card {
                padding: 30px 25px;
            }
            
            .logo-container {
                flex-direction: column;
                text-align: center;
            }
            
            .header-title h1 {
                font-size: 1.2rem;
            }
            
            .content-header h2 {
                font-size: 1.5rem;
            }
            
            .gallery-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .user-profile span {
                display: none;
            }
            
            .role-tabs {
                flex-direction: column;
            }
            
            .role-indicator {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div class="background-animation" id="particles"></div>

    <!-- Admin Login Screen -->
    <div class="admin-login-container" id="loginScreen">
        <div class="admin-login-card">
            <div class="card-decoration"></div>
            
            <div class="login-logo">
                <div class="logo-container">
                    <div class="logo-icon">
                        <div style="color: white; font-size: 32px;">ðŸŒŠ</div>
                    </div>
                    <div class="logo-text">Flood Relief Fund</div>
                </div>
            </div>
            
            <div class="login-header">
                <h1>Admin Portal</h1>
                <p>Restricted access for authorized personnel only</p>
            </div>
            
            <!-- Role Selection Tabs -->
            <div class="role-tabs">
                <div class="role-indicator"></div>
                <button class="role-btn active" data-role="admin">
                    <i class="fas fa-user-shield"></i> Administrator
                </button>
                <button class="role-btn" data-role="staff">
                    <i class="fas fa-user-tie"></i> Staff Member
                </button>
            </div>
            
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <div class="form-input-container">
                        <input type="text" name="username" class="form-input" placeholder="Enter username" required>
                        <div class="input-icon">
                            <i class="fas fa-user"></i>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <div class="form-input-container">
                        <input type="password" name="password" class="form-input" id="passwordInput" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                        <button type="button" class="password-toggle" id="passwordToggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Security Code (Optional) -->
                <div class="form-group" id="securityCodeField" style="display: none;">
                    <label class="form-label">Security Code</label>
                    <div class="form-input-container">
                        <input type="text" name="security_code" class="form-input" placeholder="Enter security code">
                        <div class="input-icon">
                            <i class="fas fa-key"></i>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="submit-btn" id="submitBtn">
                    <div class="loading-spinner"></div>
                    <span class="btn-text" id="loginButtonText">Login as Administrator</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
                
                <div class="login-links">
                    <a href="index.html" target="_blank">
                        <i class="fas fa-home"></i> Go to Homepage
                    </a>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(26, 115, 232, 0.05); border-radius: var(--border-radius);">
                        <p style="font-size: 0.8rem; color: var(--gray); margin: 0;">
                            <i class="fas fa-info-circle"></i>
                            Demo: admin/admin123 or staff/staff123
                        </p>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="dashboard-container" id="dashboardMain">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="header-title">
                    <h1 id="dashboardTitle">Admin Dashboard</h1>
                    <span class="user-badge" id="userRoleBadge">
                        <i class="fas fa-user-shield"></i>
                        Super Admin
                    </span>
                </div>
            </div>
            
            <div class="header-right">
                <div class="notification-bell" id="notificationBell">
                    <i class="fas fa-bell"></i>
                    <span class="notification-count" id="notificationCount">0</span>
                </div>
                
                <div class="user-profile" id="userProfile">
                    <img src="" alt="Admin" id="userAvatar">
                    <div class="profile-info">
                        <span class="profile-name" id="userDisplayName">Administrator</span>
                        <span class="profile-role" id="userDisplayRole">Super Admin</span>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                    
                    <div class="profile-dropdown">
                        <a href="#" onclick="showProfileModal()">
                            <i class="fas fa-user"></i>
                            <span>My Profile</span>
                        </a>
                        <a href="#" onclick="loadView('settings')">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                        <div class="divider"></div>
                        <a href="#" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-tachometer-alt"></i> Admin Navigation</h3>
            </div>
            
            <nav class="sidebar-nav">
                <ul id="sidebarNav">
                    <!-- Navigation will be loaded dynamically -->
                </ul>
                
                <div class="sidebar-footer">
                    <a href="index.html" class="back-to-site" target="_blank">
                        <i class="fas fa-external-link-alt"></i>
                        <span>Visit Homepage</span>
                    </a>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <div class="content-header">
                <h2 id="contentTitle">Dashboard Overview</h2>
                <div class="header-actions">
                    <button class="btn-refresh" id="refreshBtn">
                        <i class="fas fa-redo"></i>
                    </button>
                    <div class="date-selector">
                        <input type="date" id="dateFilter" value="2024-03-20">
                    </div>
                    <button class="btn-primary" onclick="showAddNewModal()">
                        <i class="fas fa-plus"></i>
                        Add New
                    </button>
                    <button class="btn-primary" onclick="syncToHomepage()" id="syncBtn" style="background: var(--secondary);">
                        <i class="fas fa-sync-alt"></i> Sync to Homepage
                    </button>
                </div>
            </div>
            
            <div class="content-body" id="contentBody">
                <!-- Content will be loaded dynamically -->
            </div>
        </main>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-info-circle" id="toastIcon"></i>
        <span id="toastMessage"></span>
    </div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Admin Profile</h3>
                <button class="modal-close" onclick="closeModal('profileModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="profileModalContent">
                <!-- Profile content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Gallery Modal -->
    <div class="modal" id="galleryModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 id="galleryModalTitle">Gallery Management</h3>
                <button class="modal-close" onclick="closeModal('galleryModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="galleryModalContent">
                <!-- Gallery content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div class="modal" id="notificationModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Notifications</h3>
                <button class="modal-close" onclick="closeModal('notificationModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="notificationModalContent">
                <!-- Notifications will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Donation Modal -->
    <div class="modal" id="donationModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="donationModalTitle">Donation Management</h3>
                <button class="modal-close" onclick="closeModal('donationModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="donationModalContent">
                <!-- Donation content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- News Modal -->
    <div class="modal" id="newsModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 id="newsModalTitle">News Management</h3>
                <button class="modal-close" onclick="closeModal('newsModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="newsModalContent">
                <!-- News content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Volunteer Modal -->
    <div class="modal" id="volunteerModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="volunteerModalTitle">Volunteer Management</h3>
                <button class="modal-close" onclick="closeModal('volunteerModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="volunteerModalContent">
                <!-- Volunteer content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- User Modal -->
    <div class="modal" id="userModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="userModalTitle">User Management</h3>
                <button class="modal-close" onclick="closeModal('userModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="userModalContent">
                <!-- User content will be loaded here -->
            </div>
        </div>
    </div>

<script>
    // ===== GLOBAL VARIABLES =====
    let currentView = 'overview';
    let currentRole = 'admin';
    let adminData = {
        name: 'Administrator',
        email: 'admin@floodrelieffund.org',
        role: 'Super Admin',
        username: 'admin',
        lastLogin: new Date().toISOString()
    };

    // ===== UNIFIED CREDENTIALS DATABASE =====
    const credentialsDatabase = {
        admin: [
            { username: 'admin', password: 'admin123', name: 'Administrator', role: 'Super Admin', email: 'admin@floodrelieffund.org' },
            { username: 'superadmin', password: 'super123', name: 'Super Admin', role: 'Super Admin', email: 'super@floodrelieffund.org' },
            { username: 'manager', password: 'manager123', name: 'Manager', role: 'Manager', email: 'manager@floodrelieffund.org' }
        ],
        staff: [
            { username: 'staff', password: 'staff123', name: 'Staff Member', role: 'Staff', email: 'staff@floodrelieffund.org' },
            { username: 'coordinator', password: 'coord123', name: 'Coordinator', role: 'Coordinator', email: 'coordinator@floodrelieffund.org' },
            { username: 'volunteer_coord', password: 'volunteer123', name: 'Volunteer Coordinator', role: 'Coordinator', email: 'volunteer@floodrelieffund.org' }
        ]
    };

    // ===== APPLICATION DATA =====
    let applicationData = {
        stats: {
            totalDonations: 12450,
            activeVolunteers: 48,
            ongoingProjects: 7,
            newSupporters: 127,
            pendingApprovals: 12,
            recentDonations: 8500,
            newsArticles: 24,
            galleryImages: 15
        },
        donations: [
            { id: 1, donor: 'John Smith', amount: 500, date: '2024-03-20', status: 'completed', method: 'Credit Card' },
            { id: 2, donor: 'Emma Wilson', amount: 250, date: '2024-03-19', status: 'completed', method: 'PayPal' },
            { id: 3, donor: 'Michael Brown', amount: 1000, date: '2024-03-19', status: 'pending', method: 'Bank Transfer' },
            { id: 4, donor: 'Sarah Johnson', amount: 75, date: '2024-03-18', status: 'completed', method: 'Credit Card' },
            { id: 5, donor: 'David Lee', amount: 300, date: '2024-03-18', status: 'completed', method: 'PayPal' }
        ],
        volunteers: [
            { id: 1, name: 'Alex Turner', email: 'alex@example.com', phone: '+1 234 567 8901', status: 'active', hours: 48 },
            { id: 2, name: 'Maria Garcia', email: 'maria@example.com', phone: '+1 234 567 8902', status: 'active', hours: 36 },
            { id: 3, name: 'James Wilson', email: 'james@example.com', phone: '+1 234 567 8903', status: 'pending', hours: 0 },
            { id: 4, name: 'Lisa Chen', email: 'lisa@example.com', phone: '+1 234 567 8904', status: 'active', hours: 24 },
            { id: 5, name: 'Robert Kim', email: 'robert@example.com', phone: '+1 234 567 8905', status: 'inactive', hours: 12 }
        ],
        gallery: [],
        news: [],
        users: [],
        notifications: [
            { id: 1, type: 'donation', title: 'New Donation Received', message: 'John Smith donated $500', time: '10:30 AM', read: false },
            { id: 2, type: 'volunteer', title: 'Volunteer Application', message: 'New volunteer application pending review', time: 'Yesterday', read: false },
            { id: 3, type: 'system', title: 'System Update', message: 'Scheduled maintenance tonight at 2 AM', time: '2 days ago', read: true }
        ]
    };

    // ===== INITIALIZATION =====
    
    document.addEventListener('DOMContentLoaded', function() {
        createParticles();
        setupEventListeners();
        setupRoleSelection();
        
        // Check if user is already logged in
        const isLoggedIn = localStorage.getItem('admin_logged_in');
        if (isLoggedIn) {
            // Hide login, show dashboard
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('dashboardMain').style.display = 'block';
            
            // Initialize dashboard with stored data
            const adminName = localStorage.getItem('admin_name') || 'Administrator';
            const adminRole = localStorage.getItem('admin_role') || 'Administrator';
            const adminUsername = localStorage.getItem('admin_username') || 'admin';
            const adminEmail = localStorage.getItem('admin_email') || 'admin@floodrelieffund.org';
            
            adminData = {
                name: adminName,
                email: adminEmail,
                role: adminRole,
                username: adminUsername,
                lastLogin: new Date().toISOString()
            };
            
            initializeDashboard(adminData);
        } else {
            // Show login screen with demo credentials
            setTimeout(() => {
                document.querySelector('input[name="username"]').value = 'admin';
                document.querySelector('input[name="password"]').value = 'admin123';
            }, 500);
        }
    });

    // ===== ROLE SELECTION =====
    function setupRoleSelection() {
        const roleButtons = document.querySelectorAll('.role-btn');
        const indicator = document.querySelector('.role-indicator');
        const securityCodeField = document.getElementById('securityCodeField');
        const loginButtonText = document.getElementById('loginButtonText');
        
        roleButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                currentRole = this.getAttribute('data-role');
                
                // Update active button
                roleButtons.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Move indicator
                if (currentRole === 'admin') {
                    indicator.style.transform = 'translateX(0)';
                } else {
                    indicator.style.transform = 'translateX(100%)';
                }
                
                // Show/hide security code for admin
                if (currentRole === 'admin') {
                    securityCodeField.style.display = 'block';
                    loginButtonText.textContent = 'Login as Administrator';
                } else {
                    securityCodeField.style.display = 'none';
                    loginButtonText.textContent = 'Login as Staff Member';
                }
            });
        });
    }

    // ===== PARTICLES BACKGROUND =====
    function createParticles() {
        const container = document.getElementById('particles');
        const particleCount = 15;
        
        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            const size = Math.random() * 60 + 20;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.left = `${Math.random() * 100}%`;
            particle.style.top = `${Math.random() * 100}%`;
            particle.style.animationDelay = `${Math.random() * 5}s`;
            
            container.appendChild(particle);
        }
    }

    // ===== EVENT LISTENERS =====
    function setupEventListeners() {
        // Login form
        document.getElementById('loginForm').addEventListener('submit', handleLogin);
        
        // Password toggle
        document.getElementById('passwordToggle').addEventListener('click', function() {
            const passwordInput = document.getElementById('passwordInput');
            const icon = this.querySelector('i');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                passwordInput.type = 'password';
                icon.className = 'fas fa-eye';
            }
        });
        
        // Menu toggle
        document.getElementById('menuToggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
            this.querySelector('i').className = sidebar.classList.contains('active') ? 
                'fas fa-times' : 'fas fa-bars';
        });
        
        // Refresh button
        document.getElementById('refreshBtn').addEventListener('click', function() {
            loadView(currentView, true);
            showToast('Dashboard refreshed', 'success');
        });
        
        // Logout button
        document.getElementById('logoutBtn').addEventListener('click', function(e) {
            e.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                logout();
            }
        });
        
        // Notification bell
        document.getElementById('notificationBell').addEventListener('click', function() {
            showNotificationsModal();
        });
        
        // Update notification count on load
        updateNotificationCount();
        
        // Add escape key listener for modals
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modals = document.querySelectorAll('.modal.show');
                modals.forEach(modal => {
                    modal.classList.remove('show');
                    document.body.style.overflow = 'auto';
                });
            }
        });
        
        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
        });
    }

    // ===== LOGIN HANDLER =====
    function handleLogin(e) {
        e.preventDefault();
        
        const username = document.querySelector('input[name="username"]').value.trim();
        const password = document.querySelector('input[name="password"]').value;
        
        // Validation
        if (!username || !password) {
            showToast('Please enter username and password', 'error');
            return;
        }
        
        // Show loading
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.classList.add('loading');
        
        // Simulate API call
        setTimeout(() => {
            // Check credentials based on selected role
            const userList = credentialsDatabase[currentRole];
            const user = userList.find(u => u.username === username && u.password === password);
            
            if (user) {
                showToast(`Welcome, ${user.name}!`, 'success');
                
                setTimeout(() => {
                    // Store session
                    localStorage.setItem('admin_logged_in', 'true');
                    localStorage.setItem('admin_username', user.username);
                    localStorage.setItem('admin_role', user.role);
                    localStorage.setItem('admin_name', user.name);
                    localStorage.setItem('admin_email', user.email);
                    
                    // Hide login, show dashboard
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('dashboardMain').style.display = 'block';
                    
                    // Set user data
                    adminData = {
                        name: user.name,
                        email: user.email,
                        role: user.role,
                        username: user.username,
                        lastLogin: new Date().toISOString()
                    };
                    
                    // Initialize dashboard with user data
                    initializeDashboard(adminData);
                    
                }, 500);
            } else {
                showToast(`Invalid ${currentRole} credentials`, 'error');
            }
            
            submitBtn.classList.remove('loading');
        }, 1500);
    }

    // ===== DASHBOARD INITIALIZATION =====
    function initializeDashboard(user) {
        // Update dashboard title based on role
        document.getElementById('dashboardTitle').textContent = `${user.role} Dashboard`;
        
        // Update user display
        document.getElementById('userDisplayName').textContent = user.name;
        document.getElementById('userDisplayRole').textContent = user.role;
        
        // Update user badge
        const userBadge = document.getElementById('userRoleBadge');
        userBadge.innerHTML = `
            <i class="fas fa-${user.role.includes('Admin') ? 'user-shield' : 'user-tie'}"></i>
            ${user.role}
        `;
        
        // Update profile image with user's initial
        const colors = {
            'Super Admin': '1a73e8',
            'Administrator': '0d47a1',
            'Manager': '673ab7',
            'Coordinator': 'ff9800',
            'Staff': '34a853'
        };
        
        const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name)}&background=${colors[user.role] || '1a73e8'}&color=fff&bold=true`;
        document.getElementById('userAvatar').src = avatarUrl;
        
        // Load data from localStorage
        loadDataFromStorage();
        
        // Load navigation based on role
        loadNavigation(user.role);
        
        // Load default view
        loadView('overview');
        
        // Update notifications
        updateNotificationCount();
        
        // Start notification polling (simulated)
        startNotificationPolling();
    }

    // ===== LOAD DATA FROM STORAGE =====
    function loadDataFromStorage() {
        // Load gallery from localStorage
        const storedGallery = localStorage.getItem('flood_relief_gallery');
        if (storedGallery) {
            try {
                applicationData.gallery = JSON.parse(storedGallery);
            } catch (error) {
                console.error('Error loading gallery from storage:', error);
            }
        }
        
        // Load news from localStorage
        const storedNews = localStorage.getItem('flood_relief_news');
        if (storedNews) {
            try {
                applicationData.news = JSON.parse(storedNews);
            } catch (error) {
                console.error('Error loading news from storage:', error);
            }
        }
        
        // Load donations from localStorage
        const storedDonations = localStorage.getItem('flood_relief_donations');
        if (storedDonations) {
            try {
                applicationData.donations = JSON.parse(storedDonations);
            } catch (error) {
                console.error('Error loading donations from storage:', error);
            }
        }
        
        // Load volunteers from localStorage
        const storedVolunteers = localStorage.getItem('flood_relief_volunteers');
        if (storedVolunteers) {
            try {
                applicationData.volunteers = JSON.parse(storedVolunteers);
            } catch (error) {
                console.error('Error loading volunteers from storage:', error);
            }
        }
        
        // Load users from localStorage
        const storedUsers = localStorage.getItem('flood_relief_users');
        if (storedUsers) {
            try {
                applicationData.users = JSON.parse(storedUsers);
            } catch (error) {
                console.error('Error loading users from storage:', error);
            }
        }
        
        // Load stats from localStorage
        const storedStats = localStorage.getItem('flood_relief_stats');
        if (storedStats) {
            try {
                const stats = JSON.parse(storedStats);
                // Update application data stats
                applicationData.stats = {
                    ...applicationData.stats,
                    ...stats
                };
            } catch (error) {
                console.error('Error loading stats from storage:', error);
            }
        }
    }

    // ===== LOAD NAVIGATION BASED ON ROLE =====
    function loadNavigation(role) {
        let navItems = [];
        
        // Common items for all roles
        navItems.push(
            { id: 'overview', label: 'Dashboard Overview', icon: 'fas fa-tachometer-alt' }
        );
        
        // Super Admin & Admin items
        if (role === 'Super Admin' || role === 'Administrator') {
            navItems.push(
                { id: 'donations', label: 'Donation Management', icon: 'fas fa-donate', badge: applicationData.donations.length },
                { id: 'volunteers', label: 'Volunteer Management', icon: 'fas fa-users', badge: applicationData.volunteers.length },
                { id: 'gallery', label: 'Gallery Management', icon: 'fas fa-images', badge: applicationData.gallery.length },
                { id: 'news', label: 'News Management', icon: 'fas fa-newspaper', badge: applicationData.news.length },
                { id: 'analytics', label: 'Analytics & Reports', icon: 'fas fa-chart-bar' },
                { id: 'users', label: 'User Management', icon: 'fas fa-user-cog' },
                { id: 'settings', label: 'System Settings', icon: 'fas fa-cogs' }
            );
        }
        
        // Manager items
        if (role === 'Manager') {
            navItems.push(
                { id: 'donations', label: 'Donation Management', icon: 'fas fa-donate' },
                { id: 'volunteers', label: 'Volunteer Management', icon: 'fas fa-users' },
                { id: 'gallery', label: 'Gallery Management', icon: 'fas fa-images' },
                { id: 'news', label: 'News Management', icon: 'fas fa-newspaper' },
                { id: 'reports', label: 'Reports', icon: 'fas fa-file-alt' }
            );
        }
        
        // Staff items
        if (role === 'Staff' || role === 'Coordinator') {
            navItems.push(
                { id: 'donations', label: 'Donation Management', icon: 'fas fa-donate' },
                { id: 'volunteers', label: 'Volunteer Management', icon: 'fas fa-users' },
                { id: 'gallery', label: 'Gallery Management', icon: 'fas fa-images' },
                { id: 'news', label: 'News Management', icon: 'fas fa-newspaper' }
            );
        }
        
        // Render navigation
        const sidebarNav = document.getElementById('sidebarNav');
        sidebarNav.innerHTML = navItems.map(item => `
            <li>
                <a href="#" onclick="loadView('${item.id}')" class="${currentView === item.id ? 'active' : ''}">
                    <i class="${item.icon}"></i>
                    <span>${item.label}</span>
                    ${item.badge ? `<span class="nav-badge">${item.badge}</span>` : ''}
                </a>
            </li>
        `).join('');
    }

    // ===== VIEW LOADER =====
    function loadView(viewName, forceRefresh = false) {
        currentView = viewName;
        
        // Update navigation active state
        document.querySelectorAll('.sidebar-nav a').forEach(link => {
            link.classList.remove('active');
        });
        document.querySelector(`a[onclick="loadView('${viewName}')"]`)?.classList.add('active');
        
        // Update content title
        const titleMap = {
            'overview': 'Dashboard Overview',
            'donations': 'Donation Management',
            'volunteers': 'Volunteer Management',
            'gallery': 'Gallery Management',
            'news': 'News Management',
            'analytics': 'Analytics & Reports',
            'users': 'User Management',
            'settings': 'System Settings',
            'reports': 'Reports'
        };
        document.getElementById('contentTitle').textContent = titleMap[viewName] || viewName;
        
        // Load view content
        switch(viewName) {
            case 'overview':
                loadOverviewView();
                break;
            case 'donations':
                loadDonationsView(forceRefresh);
                break;
            case 'volunteers':
                loadVolunteersView(forceRefresh);
                break;
            case 'gallery':
                loadGalleryView(forceRefresh);
                break;
            case 'news':
                loadNewsView(forceRefresh);
                break;
            case 'analytics':
                loadAnalyticsView();
                break;
            case 'users':
                loadUsersView();
                break;
            case 'settings':
                loadSettingsView();
                break;
            case 'reports':
                loadReportsView();
                break;
            default:
                loadOverviewView();
        }
    }

    // ===== DONATION MANAGEMENT =====
    function showAddDonationModal() {
        const content = `
            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Donor Name</label>
                    <input type="text" class="form-input" id="donationDonor" placeholder="Enter donor name" style="width: 100%;">
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Email Address</label>
                    <input type="email" class="form-input" id="donationEmail" placeholder="donor@example.com" style="width: 100%;">
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Amount ($)</label>
                        <input type="number" class="form-input" id="donationAmount" placeholder="0.00" min="1" step="0.01" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Date</label>
                        <input type="date" class="form-input" id="donationDate" value="${new Date().toISOString().split('T')[0]}" style="width: 100%;">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Payment Method</label>
                        <select class="form-input" id="donationMethod" style="width: 100%;">
                            <option value="Credit Card">Credit Card</option>
                            <option value="PayPal">PayPal</option>
                            <option value="Bank Transfer">Bank Transfer</option>
                            <option value="Cash">Cash</option>
                            <option value="Check">Check</option>
                            <option value="Crypto">Cryptocurrency</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Status</label>
                        <select class="form-input" id="donationStatus" style="width: 100%;">
                            <option value="pending">Pending</option>
                            <option value="completed" selected>Completed</option>
                            <option value="failed">Failed</option>
                            <option value="refunded">Refunded</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Notes/Comments</label>
                    <textarea class="form-input" id="donationNotes" placeholder="Add any notes about this donation" rows="3" style="width: 100%; resize: vertical;"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-secondary" onclick="closeModal('donationModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="saveDonation()">
                        <i class="fas fa-save"></i> Save Donation
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('donationModalContent').innerHTML = content;
        document.getElementById('donationModalTitle').textContent = 'Add New Donation';
        showModal('donationModal');
    }

    function saveDonation() {
        const donor = document.getElementById('donationDonor').value.trim();
        const email = document.getElementById('donationEmail').value.trim();
        const amount = parseFloat(document.getElementById('donationAmount').value);
        const date = document.getElementById('donationDate').value;
        const method = document.getElementById('donationMethod').value;
        const status = document.getElementById('donationStatus').value;
        const notes = document.getElementById('donationNotes').value.trim();
        
        // Validation
        if (!donor) {
            showToast('Please enter donor name', 'error');
            return;
        }
        
        if (!amount || amount <= 0) {
            showToast('Please enter a valid donation amount', 'error');
            return;
        }
        
        const newDonation = {
            id: Date.now(),
            donor: donor,
            email: email || 'N/A',
            amount: amount,
            date: date,
            method: method,
            status: status,
            notes: notes,
            timestamp: new Date().toISOString(),
            processedBy: adminData.name
        };
        
        // Add to donations array
        applicationData.donations.unshift(newDonation);
        
        // Update stats
        if (status === 'completed') {
            applicationData.stats.totalDonations += amount;
            applicationData.stats.recentDonations += amount;
        }
        applicationData.stats.newSupporters += 1;
        
        // Save to localStorage
        localStorage.setItem('flood_relief_donations', JSON.stringify(applicationData.donations));
        updateStats();
        
        // Add notification
        addNotification('donation', 'New Donation Added', `${donor} donated $${amount}`);
        
        showToast('Donation added successfully!', 'success');
        
        // Refresh donations view
        loadDonationsView(true);
        
        // Close modal
        closeModal('donationModal');
    }

    function editDonation(id) {
        const donation = applicationData.donations.find(d => d.id === id);
        if (!donation) {
            showToast('Donation not found', 'error');
            return;
        }
        
        const content = `
            <div style="display: grid; gap: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: var(--light); border-radius: var(--border-radius);">
                    <div>
                        <strong style="color: var(--dark); font-size: 1.1rem;">Donation #${donation.id.toString().padStart(4, '0')}</strong>
                        <div style="font-size: 0.9rem; color: var(--gray); margin-top: 5px;">
                            Added on ${new Date(donation.timestamp).toLocaleDateString()} by ${donation.processedBy || 'System'}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);">$${donation.amount.toLocaleString()}</div>
                        <span class="badge badge-${donation.status === 'completed' ? 'success' : donation.status === 'pending' ? 'warning' : 'danger'}">
                            ${donation.status}
                        </span>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Donor Name</label>
                        <input type="text" class="form-input" id="editDonationDonor" value="${donation.donor}" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Email Address</label>
                        <input type="email" class="form-input" id="editDonationEmail" value="${donation.email || ''}" style="width: 100%;">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Amount ($)</label>
                        <input type="number" class="form-input" id="editDonationAmount" value="${donation.amount}" min="1" step="0.01" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Date</label>
                        <input type="date" class="form-input" id="editDonationDate" value="${donation.date}" style="width: 100%;">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Payment Method</label>
                        <select class="form-input" id="editDonationMethod" style="width: 100%;">
                            <option value="Credit Card" ${donation.method === 'Credit Card' ? 'selected' : ''}>Credit Card</option>
                            <option value="PayPal" ${donation.method === 'PayPal' ? 'selected' : ''}>PayPal</option>
                            <option value="Bank Transfer" ${donation.method === 'Bank Transfer' ? 'selected' : ''}>Bank Transfer</option>
                            <option value="Cash" ${donation.method === 'Cash' ? 'selected' : ''}>Cash</option>
                            <option value="Check" ${donation.method === 'Check' ? 'selected' : ''}>Check</option>
                            <option value="Crypto" ${donation.method === 'Crypto' ? 'selected' : ''}>Cryptocurrency</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Status</label>
                        <select class="form-input" id="editDonationStatus" style="width: 100%;">
                            <option value="pending" ${donation.status === 'pending' ? 'selected' : ''}>Pending</option>
                            <option value="completed" ${donation.status === 'completed' ? 'selected' : ''}>Completed</option>
                            <option value="failed" ${donation.status === 'failed' ? 'selected' : ''}>Failed</option>
                            <option value="refunded" ${donation.status === 'refunded' ? 'selected' : ''}>Refunded</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Notes/Comments</label>
                    <textarea class="form-input" id="editDonationNotes" rows="3" style="width: 100%; resize: vertical;">${donation.notes || ''}</textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-delete" onclick="deleteDonation(${donation.id}); closeModal('donationModal');">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                    <button class="btn-secondary" onclick="closeModal('donationModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="updateDonation(${donation.id})">
                        <i class="fas fa-save"></i> Update Donation
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('donationModalContent').innerHTML = content;
        document.getElementById('donationModalTitle').textContent = 'Edit Donation';
        showModal('donationModal');
    }

    function updateDonation(id) {
        const donationIndex = applicationData.donations.findIndex(d => d.id === id);
        if (donationIndex === -1) {
            showToast('Donation not found', 'error');
            return;
        }
        
        const donor = document.getElementById('editDonationDonor').value.trim();
        const email = document.getElementById('editDonationEmail').value.trim();
        const amount = parseFloat(document.getElementById('editDonationAmount').value);
        const date = document.getElementById('editDonationDate').value;
        const method = document.getElementById('editDonationMethod').value;
        const status = document.getElementById('editDonationStatus').value;
        const notes = document.getElementById('editDonationNotes').value.trim();
        
        // Validation
        if (!donor) {
            showToast('Please enter donor name', 'error');
            return;
        }
        
        if (!amount || amount <= 0) {
            showToast('Please enter a valid donation amount', 'error');
            return;
        }
        
        const oldDonation = applicationData.donations[donationIndex];
        const oldAmount = oldDonation.amount;
        const oldStatus = oldDonation.status;
        
        // Update donation
        applicationData.donations[donationIndex] = {
            ...oldDonation,
            donor: donor,
            email: email || 'N/A',
            amount: amount,
            date: date,
            method: method,
            status: status,
            notes: notes,
            lastUpdated: new Date().toISOString(),
            updatedBy: adminData.name
        };
        
        // Update stats based on status changes
        if (oldStatus === 'completed' && status !== 'completed') {
            applicationData.stats.totalDonations -= oldAmount;
            applicationData.stats.recentDonations -= oldAmount;
        } else if (oldStatus !== 'completed' && status === 'completed') {
            applicationData.stats.totalDonations += amount;
            applicationData.stats.recentDonations += amount;
        } else if (oldStatus === 'completed' && status === 'completed' && amount !== oldAmount) {
            applicationData.stats.totalDonations += (amount - oldAmount);
            applicationData.stats.recentDonations += (amount - oldAmount);
        }
        
        // Save to localStorage
        localStorage.setItem('flood_relief_donations', JSON.stringify(applicationData.donations));
        updateStats();
        
        showToast('Donation updated successfully!', 'success');
        
        // Refresh donations view
        loadDonationsView(true);
        
        // Close modal
        closeModal('donationModal');
    }

    function deleteDonation(id) {
        if (confirm('Are you sure you want to delete this donation? This action cannot be undone.')) {
            const donationIndex = applicationData.donations.findIndex(d => d.id === id);
            if (donationIndex === -1) {
                showToast('Donation not found', 'error');
                return;
            }
            
            const donation = applicationData.donations[donationIndex];
            
            // Update stats if donation was completed
            if (donation.status === 'completed') {
                applicationData.stats.totalDonations -= donation.amount;
                applicationData.stats.recentDonations -= donation.amount;
                applicationData.stats.newSupporters -= 1;
            }
            
            // Remove donation
            applicationData.donations.splice(donationIndex, 1);
            
            // Save to localStorage
            localStorage.setItem('flood_relief_donations', JSON.stringify(applicationData.donations));
            updateStats();
            
            showToast('Donation deleted successfully', 'success');
            loadDonationsView(true);
        }
    }

    function exportDonations() {
        const data = applicationData.donations.map(donation => ({
            'Donation ID': donation.id,
            'Donor Name': donation.donor,
            'Email': donation.email,
            'Amount': donation.amount,
            'Date': donation.date,
            'Payment Method': donation.method,
            'Status': donation.status,
            'Processed By': donation.processedBy,
            'Notes': donation.notes
        }));
        
        // Convert to CSV
        const csvContent = [
            Object.keys(data[0] || {}).join(','),
            ...data.map(row => Object.values(row).map(value => 
                `"${String(value).replace(/"/g, '""')}"`
            ).join(','))
        ].join('\n');
        
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        
        link.setAttribute('href', url);
        link.setAttribute('download', `donations_export_${new Date().toISOString().split('T')[0]}.csv`);
        link.style.visibility = 'hidden';
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showToast('Donations exported successfully!', 'success');
    }

    // ===== VOLUNTEER MANAGEMENT =====
    function loadVolunteersView(forceRefresh = false) {
        // Load volunteers from localStorage
        const storedVolunteers = localStorage.getItem('flood_relief_volunteers');
        if (storedVolunteers) {
            try {
                applicationData.volunteers = JSON.parse(storedVolunteers);
            } catch (error) {
                console.error('Error loading volunteers from storage:', error);
            }
        }
        
        const activeVolunteers = applicationData.volunteers.filter(v => v.status === 'active').length;
        const pendingVolunteers = applicationData.volunteers.filter(v => v.status === 'pending').length;
        
        const content = `
            <div class="gallery-header">
                <h3 style="margin: 0;">Volunteer Management (${applicationData.volunteers.length})</h3>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-secondary" onclick="exportVolunteers()">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn-primary" onclick="showAddVolunteerModal()">
                        <i class="fas fa-plus"></i> Add Volunteer
                    </button>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow); text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary);">${activeVolunteers}</div>
                    <div style="color: var(--gray);">Active Volunteers</div>
                </div>
                <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow); text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 700; color: var(--warning);">${pendingVolunteers}</div>
                    <div style="color: var(--gray);">Pending Approval</div>
                </div>
                <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow); text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 700; color: var(--secondary);">
                        ${applicationData.volunteers.reduce((sum, v) => sum + (v.hours || 0), 0)}
                    </div>
                    <div style="color: var(--gray);">Total Hours Served</div>
                </div>
            </div>
            
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Contact</th>
                            <th>Status</th>
                            <th>Hours</th>
                            <th>Skills</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${applicationData.volunteers.map((volunteer, index) => `
                            <tr>
                                <td>#${(index + 1).toString().padStart(3, '0')}</td>
                                <td>
                                    <strong>${volunteer.name}</strong>
                                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 2px;">
                                        ${volunteer.email}
                                    </div>
                                </td>
                                <td>${volunteer.phone || 'N/A'}</td>
                                <td>
                                    <span class="badge badge-${volunteer.status === 'active' ? 'success' : volunteer.status === 'pending' ? 'warning' : 'danger'}">
                                        ${volunteer.status}
                                    </span>
                                </td>
                                <td>
                                    <strong style="color: var(--primary);">${volunteer.hours || 0}</strong>
                                </td>
                                <td>
                                    <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                        ${(volunteer.skills || []).slice(0, 2).map(skill => `
                                            <span style="background: var(--light); padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; color: var(--gray);">
                                                ${skill}
                                            </span>
                                        `).join('')}
                                        ${(volunteer.skills || []).length > 2 ? `
                                            <span style="background: var(--light); padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; color: var(--gray);">
                                                +${(volunteer.skills || []).length - 2}
                                            </span>
                                        ` : ''}
                                    </div>
                                </td>
                                <td>
                                    <button class="btn-edit" onclick="editVolunteer(${index})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-delete" onclick="deleteVolunteer(${index})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                    ${volunteer.status === 'pending' ? `
                                        <button class="btn-secondary" onclick="approveVolunteer(${index})" style="margin-left: 5px;">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    ` : ''}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
            
            ${applicationData.volunteers.length === 0 ? `
                <div style="text-align: center; padding: 50px 20px; background: white; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                    <i class="fas fa-users fa-4x" style="color: var(--light-gray); margin-bottom: 20px;"></i>
                    <h4 style="color: var(--gray); margin-bottom: 10px;">No Volunteers Yet</h4>
                    <p style="color: var(--gray); margin-bottom: 20px;">Start by adding your first volunteer</p>
                    <button class="btn-primary" onclick="showAddVolunteerModal()">
                        <i class="fas fa-plus"></i> Add Volunteer
                    </button>
                </div>
            ` : ''}
        `;
        
        document.getElementById('contentBody').innerHTML = content;
    }

    function showAddVolunteerModal() {
        const content = `
            <div style="display: grid; gap: 20px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">First Name</label>
                        <input type="text" class="form-input" id="volunteerFirstName" placeholder="John" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Last Name</label>
                        <input type="text" class="form-input" id="volunteerLastName" placeholder="Doe" style="width: 100%;">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Email Address</label>
                        <input type="email" class="form-input" id="volunteerEmail" placeholder="volunteer@example.com" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Phone Number</label>
                        <input type="tel" class="form-input" id="volunteerPhone" placeholder="+1 234 567 8900" style="width: 100%;">
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Address</label>
                    <input type="text" class="form-input" id="volunteerAddress" placeholder="123 Main St, City, Country" style="width: 100%;">
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Skills (comma-separated)</label>
                    <input type="text" class="form-input" id="volunteerSkills" placeholder="First Aid, Logistics, Communication, Cooking" style="width: 100%;">
                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 5px;">
                        Enter skills separated by commas
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Status</label>
                        <select class="form-input" id="volunteerStatus" style="width: 100%;">
                            <option value="active">Active</option>
                            <option value="pending" selected>Pending</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Hours Served</label>
                        <input type="number" class="form-input" id="volunteerHours" value="0" min="0" style="width: 100%;">
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Notes</label>
                    <textarea class="form-input" id="volunteerNotes" placeholder="Add any notes about this volunteer" rows="3" style="width: 100%; resize: vertical;"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-secondary" onclick="closeModal('volunteerModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="saveVolunteer()">
                        <i class="fas fa-save"></i> Save Volunteer
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('volunteerModalContent').innerHTML = content;
        document.getElementById('volunteerModalTitle').textContent = 'Add Volunteer';
        showModal('volunteerModal');
    }

    function saveVolunteer() {
        const firstName = document.getElementById('volunteerFirstName').value.trim();
        const lastName = document.getElementById('volunteerLastName').value.trim();
        const email = document.getElementById('volunteerEmail').value.trim();
        const phone = document.getElementById('volunteerPhone').value.trim();
        const address = document.getElementById('volunteerAddress').value.trim();
        const skills = document.getElementById('volunteerSkills').value.trim();
        const status = document.getElementById('volunteerStatus').value;
        const hours = parseInt(document.getElementById('volunteerHours').value) || 0;
        const notes = document.getElementById('volunteerNotes').value.trim();
        
        // Validation
        if (!firstName || !lastName) {
            showToast('Please enter volunteer name', 'error');
            return;
        }
        
        if (!email) {
            showToast('Please enter email address', 'error');
            return;
        }
        
        const newVolunteer = {
            id: Date.now(),
            name: `${firstName} ${lastName}`,
            email: email,
            phone: phone || 'N/A',
            address: address || 'N/A',
            skills: skills ? skills.split(',').map(s => s.trim()).filter(s => s) : [],
            status: status,
            hours: hours,
            notes: notes,
            joinDate: new Date().toISOString().split('T')[0],
            registeredBy: adminData.name,
            lastActivity: new Date().toISOString()
        };
        
        // Add to volunteers array
        applicationData.volunteers.unshift(newVolunteer);
        
        // Update stats
        if (status === 'active') {
            applicationData.stats.activeVolunteers += 1;
        } else if (status === 'pending') {
            applicationData.stats.pendingApprovals += 1;
        }
        
        // Save to localStorage
        localStorage.setItem('flood_relief_volunteers', JSON.stringify(applicationData.volunteers));
        updateStats();
        
        // Add notification
        addNotification('volunteer', 'New Volunteer Added', `${newVolunteer.name} has been added as ${status} volunteer`);
        
        showToast('Volunteer added successfully!', 'success');
        
        // Refresh volunteers view
        loadVolunteersView(true);
        
        // Close modal
        closeModal('volunteerModal');
    }

    function editVolunteer(index) {
        const volunteer = applicationData.volunteers[index];
        const nameParts = volunteer.name.split(' ');
        const firstName = nameParts[0] || '';
        const lastName = nameParts.slice(1).join(' ') || '';
        
        const content = `
            <div style="display: grid; gap: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: var(--light); border-radius: var(--border-radius);">
                    <div>
                        <strong style="color: var(--dark); font-size: 1.1rem;">${volunteer.name}</strong>
                        <div style="font-size: 0.9rem; color: var(--gray); margin-top: 5px;">
                            Joined on ${volunteer.joinDate} | Last activity: ${new Date(volunteer.lastActivity).toLocaleDateString()}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--primary);">${volunteer.hours || 0} hours</div>
                        <span class="badge badge-${volunteer.status === 'active' ? 'success' : volunteer.status === 'pending' ? 'warning' : 'danger'}">
                            ${volunteer.status}
                        </span>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">First Name</label>
                        <input type="text" class="form-input" id="editVolunteerFirstName" value="${firstName}" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Last Name</label>
                        <input type="text" class="form-input" id="editVolunteerLastName" value="${lastName}" style="width: 100%;">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Email Address</label>
                        <input type="email" class="form-input" id="editVolunteerEmail" value="${volunteer.email}" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Phone Number</label>
                        <input type="tel" class="form-input" id="editVolunteerPhone" value="${volunteer.phone || ''}" style="width: 100%;">
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Address</label>
                    <input type="text" class="form-input" id="editVolunteerAddress" value="${volunteer.address || ''}" style="width: 100%;">
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Skills (comma-separated)</label>
                    <input type="text" class="form-input" id="editVolunteerSkills" value="${volunteer.skills.join(', ')}" style="width: 100%;">
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Status</label>
                        <select class="form-input" id="editVolunteerStatus" style="width: 100%;">
                            <option value="active" ${volunteer.status === 'active' ? 'selected' : ''}>Active</option>
                            <option value="pending" ${volunteer.status === 'pending' ? 'selected' : ''}>Pending</option>
                            <option value="inactive" ${volunteer.status === 'inactive' ? 'selected' : ''}>Inactive</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Hours Served</label>
                        <input type="number" class="form-input" id="editVolunteerHours" value="${volunteer.hours || 0}" min="0" style="width: 100%;">
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Notes</label>
                    <textarea class="form-input" id="editVolunteerNotes" rows="3" style="width: 100%; resize: vertical;">${volunteer.notes || ''}</textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-delete" onclick="deleteVolunteer(${index}); closeModal('volunteerModal');">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                    <button class="btn-secondary" onclick="closeModal('volunteerModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="updateVolunteer(${index})">
                        <i class="fas fa-save"></i> Update Volunteer
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('volunteerModalContent').innerHTML = content;
        document.getElementById('volunteerModalTitle').textContent = 'Edit Volunteer';
        showModal('volunteerModal');
    }

    function updateVolunteer(index) {
        const firstName = document.getElementById('editVolunteerFirstName').value.trim();
        const lastName = document.getElementById('editVolunteerLastName').value.trim();
        const email = document.getElementById('editVolunteerEmail').value.trim();
        const phone = document.getElementById('editVolunteerPhone').value.trim();
        const address = document.getElementById('editVolunteerAddress').value.trim();
        const skills = document.getElementById('editVolunteerSkills').value.trim();
        const status = document.getElementById('editVolunteerStatus').value;
        const hours = parseInt(document.getElementById('editVolunteerHours').value) || 0;
        const notes = document.getElementById('editVolunteerNotes').value.trim();
        
        // Validation
        if (!firstName || !lastName) {
            showToast('Please enter volunteer name', 'error');
            return;
        }
        
        if (!email) {
            showToast('Please enter email address', 'error');
            return;
        }
        
        const oldVolunteer = applicationData.volunteers[index];
        const oldStatus = oldVolunteer.status;
        
        // Update volunteer
        applicationData.volunteers[index] = {
            ...oldVolunteer,
            name: `${firstName} ${lastName}`,
            email: email,
            phone: phone || 'N/A',
            address: address || 'N/A',
            skills: skills ? skills.split(',').map(s => s.trim()).filter(s => s) : [],
            status: status,
            hours: hours,
            notes: notes,
            lastUpdated: new Date().toISOString(),
            updatedBy: adminData.name
        };
        
        // Update stats based on status changes
        if (oldStatus === 'active' && status !== 'active') {
            applicationData.stats.activeVolunteers -= 1;
        } else if (oldStatus !== 'active' && status === 'active') {
            applicationData.stats.activeVolunteers += 1;
        }
        
        if (oldStatus === 'pending' && status !== 'pending') {
            applicationData.stats.pendingApprovals -= 1;
        } else if (oldStatus !== 'pending' && status === 'pending') {
            applicationData.stats.pendingApprovals += 1;
        }
        
        // Save to localStorage
        localStorage.setItem('flood_relief_volunteers', JSON.stringify(applicationData.volunteers));
        updateStats();
        
        showToast('Volunteer updated successfully!', 'success');
        
        // Refresh volunteers view
        loadVolunteersView(true);
        
        // Close modal
        closeModal('volunteerModal');
    }

    function deleteVolunteer(index) {
        if (confirm('Are you sure you want to delete this volunteer?')) {
            const volunteer = applicationData.volunteers[index];
            
            // Update stats
            if (volunteer.status === 'active') {
                applicationData.stats.activeVolunteers -= 1;
            } else if (volunteer.status === 'pending') {
                applicationData.stats.pendingApprovals -= 1;
            }
            
            // Remove volunteer
            applicationData.volunteers.splice(index, 1);
            
            // Save to localStorage
            localStorage.setItem('flood_relief_volunteers', JSON.stringify(applicationData.volunteers));
            updateStats();
            
            showToast('Volunteer deleted successfully', 'success');
            loadVolunteersView(true);
        }
    }

    function approveVolunteer(index) {
        const volunteer = applicationData.volunteers[index];
        
        if (volunteer.status === 'pending') {
            volunteer.status = 'active';
            volunteer.approvedBy = adminData.name;
            volunteer.approvalDate = new Date().toISOString();
            
            // Update stats
            applicationData.stats.activeVolunteers += 1;
            applicationData.stats.pendingApprovals -= 1;
            
            // Save to localStorage
            localStorage.setItem('flood_relief_volunteers', JSON.stringify(applicationData.volunteers));
            updateStats();
            
            showToast(`${volunteer.name} has been approved as an active volunteer!`, 'success');
            loadVolunteersView(true);
        }
    }

    function exportVolunteers() {
        const data = applicationData.volunteers.map(volunteer => ({
            'Name': volunteer.name,
            'Email': volunteer.email,
            'Phone': volunteer.phone,
            'Address': volunteer.address,
            'Status': volunteer.status,
            'Hours Served': volunteer.hours,
            'Skills': volunteer.skills.join(', '),
            'Join Date': volunteer.joinDate,
            'Notes': volunteer.notes
        }));
        
        // Convert to CSV
        const csvContent = [
            Object.keys(data[0] || {}).join(','),
            ...data.map(row => Object.values(row).map(value => 
                `"${String(value).replace(/"/g, '""')}"`
            ).join(','))
        ].join('\n');
        
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        
        link.setAttribute('href', url);
        link.setAttribute('download', `volunteers_export_${new Date().toISOString().split('T')[0]}.csv`);
        link.style.visibility = 'hidden';
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showToast('Volunteers exported successfully!', 'success');
    }

    // ===== USER MANAGEMENT =====
    function loadUsersView() {
        // Load users from localStorage
        const storedUsers = localStorage.getItem('flood_relief_users');
        if (storedUsers) {
            try {
                applicationData.users = JSON.parse(storedUsers);
            } catch (error) {
                // Initialize with demo users if not exists
                applicationData.users = [
                    { id: 1, username: 'admin', name: 'Administrator', email: 'admin@floodrelief.org', role: 'Super Admin', status: 'active', lastLogin: '2024-03-20 14:30' },
                    { id: 2, username: 'manager', name: 'Project Manager', email: 'manager@floodrelief.org', role: 'Manager', status: 'active', lastLogin: '2024-03-19 09:15' },
                    { id: 3, username: 'coordinator', name: 'Volunteer Coordinator', email: 'coordinator@floodrelief.org', role: 'Coordinator', status: 'active', lastLogin: '2024-03-18 16:45' },
                    { id: 4, username: 'staff', name: 'Staff Member', email: 'staff@floodrelief.org', role: 'Staff', status: 'inactive', lastLogin: '2024-03-15 11:20' }
                ];
            }
        } else {
            // Initialize with demo users
            applicationData.users = [
                { id: 1, username: 'admin', name: 'Administrator', email: 'admin@floodrelief.org', role: 'Super Admin', status: 'active', lastLogin: '2024-03-20 14:30' },
                { id: 2, username: 'manager', name: 'Project Manager', email: 'manager@floodrelief.org', role: 'Manager', status: 'active', lastLogin: '2024-03-19 09:15' },
                { id: 3, username: 'coordinator', name: 'Volunteer Coordinator', email: 'coordinator@floodrelief.org', role: 'Coordinator', status: 'active', lastLogin: '2024-03-18 16:45' },
                { id: 4, username: 'staff', name: 'Staff Member', email: 'staff@floodrelief.org', role: 'Staff', status: 'inactive', lastLogin: '2024-03-15 11:20' }
            ];
            localStorage.setItem('flood_relief_users', JSON.stringify(applicationData.users));
        }
        
        const activeUsers = applicationData.users.filter(u => u.status === 'active').length;
        const adminUsers = applicationData.users.filter(u => u.role.includes('Admin')).length;
        
        const content = `
            <div class="gallery-header">
                <h3 style="margin: 0;">User Management (${applicationData.users.length})</h3>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-secondary" onclick="exportUsers()">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn-primary" onclick="showAddUserModal()">
                        <i class="fas fa-plus"></i> Add User
                    </button>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow); text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary);">${applicationData.users.length}</div>
                    <div style="color: var(--gray);">Total Users</div>
                </div>
                <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow); text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 700; color: var(--secondary);">${activeUsers}</div>
                    <div style="color: var(--gray);">Active Users</div>
                </div>
                <div style="background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow); text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 700; color: var(--warning);">${adminUsers}</div>
                    <div style="color: var(--gray);">Administrators</div>
                </div>
            </div>
            
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Username</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Status</th>
                            <th>Last Login</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${applicationData.users.map((user, index) => `
                            <tr>
                                <td>#${user.id.toString().padStart(3, '0')}</td>
                                <td>
                                    <strong>${user.username}</strong>
                                </td>
                                <td>${user.name}</td>
                                <td>${user.email}</td>
                                <td>
                                    <span class="badge ${user.role.includes('Admin') ? 'badge-info' : user.role === 'Manager' ? 'badge-warning' : 'badge-success'}">
                                        ${user.role}
                                    </span>
                                </td>
                                <td>
                                    <span class="badge badge-${user.status === 'active' ? 'success' : 'danger'}">
                                        ${user.status}
                                    </span>
                                </td>
                                <td>${user.lastLogin || 'Never'}</td>
                                <td>
                                    <button class="btn-edit" onclick="editUser(${index})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-delete" onclick="deleteUser(${index})" ${user.username === adminData.username ? 'disabled style="opacity: 0.5;"' : ''}>
                                        <i class="fas fa-trash"></i>
                                    </button>
                                    <button class="btn-secondary" onclick="toggleUserStatus(${index})" style="margin-left: 5px;">
                                        <i class="fas fa-power-off"></i>
                                    </button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
        `;
        
        document.getElementById('contentBody').innerHTML = content;
    }

    function showAddUserModal() {
        const content = `
            <div style="display: grid; gap: 20px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Username</label>
                        <input type="text" class="form-input" id="userUsername" placeholder="johndoe" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Full Name</label>
                        <input type="text" class="form-input" id="userName" placeholder="John Doe" style="width: 100%;">
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Email Address</label>
                    <input type="email" class="form-input" id="userEmail" placeholder="user@floodrelief.org" style="width: 100%;">
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Role</label>
                        <select class="form-input" id="userRole" style="width: 100%;">
                            <option value="Staff">Staff</option>
                            <option value="Coordinator">Coordinator</option>
                            <option value="Manager">Manager</option>
                            <option value="Administrator">Administrator</option>
                            <option value="Super Admin">Super Admin</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Status</label>
                        <select class="form-input" id="userStatus" style="width: 100%;">
                            <option value="active" selected>Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Password</label>
                        <input type="password" class="form-input" id="userPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" style="width: 100%;">
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Confirm Password</label>
                        <input type="password" class="form-input" id="userConfirmPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" style="width: 100%;">
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Permissions</label>
                    <div style="background: var(--light); padding: 15px; border-radius: var(--border-radius);">
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" checked>
                                <span style="font-size: 0.9rem;">View Dashboard</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" checked>
                                <span style="font-size: 0.9rem;">Manage Donations</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" checked>
                                <span style="font-size: 0.9rem;">Manage Volunteers</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox">
                                <span style="font-size: 0.9rem;">Manage Users</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" checked>
                                <span style="font-size: 0.9rem;">Manage Gallery</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" checked>
                                <span style="font-size: 0.9rem;">Manage News</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-secondary" onclick="closeModal('userModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="saveUser()">
                        <i class="fas fa-save"></i> Save User
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('userModalContent').innerHTML = content;
        document.getElementById('userModalTitle').textContent = 'Add User';
        showModal('userModal');
    }

    function saveUser() {
        const username = document.getElementById('userUsername').value.trim();
        const name = document.getElementById('userName').value.trim();
        const email = document.getElementById('userEmail').value.trim();
        const role = document.getElementById('userRole').value;
        const status = document.getElementById('userStatus').value;
        const password = document.getElementById('userPassword').value;
        const confirmPassword = document.getElementById('userConfirmPassword').value;
        
        // Validation
        if (!username || !name || !email) {
            showToast('Please fill in all required fields', 'error');
            return;
        }
        
        if (!password) {
            showToast('Please enter a password', 'error');
            return;
        }
        
        if (password !== confirmPassword) {
            showToast('Passwords do not match', 'error');
            return;
        }
        
        // Check if username already exists
        if (applicationData.users.some(u => u.username === username)) {
            showToast('Username already exists', 'error');
            return;
        }
        
        const newUser = {
            id: Date.now(),
            username: username,
            name: name,
            email: email,
            role: role,
            status: status,
            password: password, // In real app, this should be hashed
            createdBy: adminData.name,
            createdDate: new Date().toISOString(),
            lastLogin: null,
            permissions: {
                dashboard: true,
                donations: true,
                volunteers: true,
                users: role.includes('Admin'),
                gallery: true,
                news: true
            }
        };
        
        // Add to users array
        applicationData.users.push(newUser);
        
        // Save to localStorage
        localStorage.setItem('flood_relief_users', JSON.stringify(applicationData.users));
        
        // Also add to credentials database for login
        if (!credentialsDatabase[role.includes('Admin') ? 'admin' : 'staff'].some(u => u.username === username)) {
            credentialsDatabase[role.includes('Admin') ? 'admin' : 'staff'].push({
                username: username,
                password: password,
                name: name,
                role: role,
                email: email
            });
        }
        
        showToast('User added successfully!', 'success');
        
        // Refresh users view
        loadUsersView();
        
        // Close modal
        closeModal('userModal');
    }

    function editUser(index) {
        const user = applicationData.users[index];
        
        const content = `
            <div style="display: grid; gap: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: var(--light); border-radius: var(--border-radius);">
                    <div>
                        <strong style="color: var(--dark); font-size: 1.1rem;">${user.name}</strong>
                        <div style="font-size: 0.9rem; color: var(--gray); margin-top: 5px;">
                            Created on ${new Date(user.createdDate).toLocaleDateString()} by ${user.createdBy}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 1.1rem; font-weight: 700; color: var(--primary);">${user.username}</div>
                        <span class="badge badge-${user.status === 'active' ? 'success' : 'danger'}">
                            ${user.status}
                        </span>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Username</label>
                        <input type="text" class="form-input" id="editUserUsername" value="${user.username}" style="width: 100%;" ${user.username === adminData.username ? 'readonly' : ''}>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Full Name</label>
                        <input type="text" class="form-input" id="editUserName" value="${user.name}" style="width: 100%;">
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Email Address</label>
                    <input type="email" class="form-input" id="editUserEmail" value="${user.email}" style="width: 100%;">
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Role</label>
                        <select class="form-input" id="editUserRole" style="width: 100%;" ${user.username === adminData.username ? 'disabled' : ''}>
                            <option value="Staff" ${user.role === 'Staff' ? 'selected' : ''}>Staff</option>
                            <option value="Coordinator" ${user.role === 'Coordinator' ? 'selected' : ''}>Coordinator</option>
                            <option value="Manager" ${user.role === 'Manager' ? 'selected' : ''}>Manager</option>
                            <option value="Administrator" ${user.role === 'Administrator' ? 'selected' : ''}>Administrator</option>
                            <option value="Super Admin" ${user.role === 'Super Admin' ? 'selected' : ''}>Super Admin</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Status</label>
                        <select class="form-input" id="editUserStatus" style="width: 100%;" ${user.username === adminData.username ? 'disabled' : ''}>
                            <option value="active" ${user.status === 'active' ? 'selected' : ''}>Active</option>
                            <option value="inactive" ${user.status === 'inactive' ? 'selected' : ''}>Inactive</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Change Password (optional)</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <input type="password" class="form-input" id="editUserPassword" placeholder="Leave blank to keep current" style="width: 100%;">
                        <input type="password" class="form-input" id="editUserConfirmPassword" placeholder="Confirm new password" style="width: 100%;">
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    ${user.username !== adminData.username ? `
                        <button class="btn-delete" onclick="deleteUser(${index}); closeModal('userModal');">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    ` : ''}
                    <button class="btn-secondary" onclick="closeModal('userModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="updateUser(${index})">
                        <i class="fas fa-save"></i> Update User
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('userModalContent').innerHTML = content;
        document.getElementById('userModalTitle').textContent = 'Edit User';
        showModal('userModal');
    }

    function updateUser(index) {
        const username = document.getElementById('editUserUsername').value.trim();
        const name = document.getElementById('editUserName').value.trim();
        const email = document.getElementById('editUserEmail').value.trim();
        const role = document.getElementById('editUserRole').value;
        const status = document.getElementById('editUserStatus').value;
        const password = document.getElementById('editUserPassword').value;
        const confirmPassword = document.getElementById('editUserConfirmPassword').value;
        
        // Validation
        if (!username || !name || !email) {
            showToast('Please fill in all required fields', 'error');
            return;
        }
        
        if (password && password !== confirmPassword) {
            showToast('Passwords do not match', 'error');
            return;
        }
        
        const user = applicationData.users[index];
        
        // Check if username already exists (if changed)
        if (username !== user.username && applicationData.users.some(u => u.username === username && u.id !== user.id)) {
            showToast('Username already exists', 'error');
            return;
        }
        
        // Update user
        const updatedUser = {
            ...user,
            username: username,
            name: name,
            email: email,
            role: user.username === adminData.username ? user.role : role, // Don't change own role
            status: user.username === adminData.username ? user.status : status, // Don't deactivate self
            updatedBy: adminData.name,
            updatedDate: new Date().toISOString()
        };
        
        // Update password if provided
        if (password) {
            updatedUser.password = password;
            
            // Also update in credentials database
            const credDb = user.role.includes('Admin') ? 'admin' : 'staff';
            const credIndex = credentialsDatabase[credDb].findIndex(u => u.username === user.username);
            if (credIndex !== -1) {
                credentialsDatabase[credDb][credIndex].password = password;
                credentialsDatabase[credDb][credIndex].name = name;
                credentialsDatabase[credDb][credIndex].role = role;
                credentialsDatabase[credDb][credIndex].email = email;
            }
        }
        
        applicationData.users[index] = updatedUser;
        
        // Save to localStorage
        localStorage.setItem('flood_relief_users', JSON.stringify(applicationData.users));
        
        showToast('User updated successfully!', 'success');
        
        // Refresh users view
        loadUsersView();
        
        // Close modal
        closeModal('userModal');
    }

    function deleteUser(index) {
        const user = applicationData.users[index];
        
        if (user.username === adminData.username) {
            showToast('You cannot delete your own account', 'error');
            return;
        }
        
        if (confirm(`Are you sure you want to delete user "${user.name}"? This action cannot be undone.`)) {
            // Remove from users array
            applicationData.users.splice(index, 1);
            
            // Remove from credentials database
            const credDb = user.role.includes('Admin') ? 'admin' : 'staff';
            const credIndex = credentialsDatabase[credDb].findIndex(u => u.username === user.username);
            if (credIndex !== -1) {
                credentialsDatabase[credDb].splice(credIndex, 1);
            }
            
            // Save to localStorage
            localStorage.setItem('flood_relief_users', JSON.stringify(applicationData.users));
            
            showToast('User deleted successfully', 'success');
            loadUsersView();
        }
    }

    function toggleUserStatus(index) {
        const user = applicationData.users[index];
        
        if (user.username === adminData.username) {
            showToast('You cannot deactivate your own account', 'error');
            return;
        }
        
        const newStatus = user.status === 'active' ? 'inactive' : 'active';
        user.status = newStatus;
        
        // Save to localStorage
        localStorage.setItem('flood_relief_users', JSON.stringify(applicationData.users));
        
        showToast(`User ${newStatus === 'active' ? 'activated' : 'deactivated'} successfully`, 'success');
        loadUsersView();
    }

    function exportUsers() {
        const data = applicationData.users.map(user => ({
            'User ID': user.id,
            'Username': user.username,
            'Name': user.name,
            'Email': user.email,
            'Role': user.role,
            'Status': user.status,
            'Created By': user.createdBy,
            'Created Date': user.createdDate,
            'Last Login': user.lastLogin
        }));
        
        // Convert to CSV
        const csvContent = [
            Object.keys(data[0] || {}).join(','),
            ...data.map(row => Object.values(row).map(value => 
                `"${String(value).replace(/"/g, '""')}"`
            ).join(','))
        ].join('\n');
        
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        
        link.setAttribute('href', url);
        link.setAttribute('download', `users_export_${new Date().toISOString().split('T')[0]}.csv`);
        link.style.visibility = 'hidden';
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showToast('Users exported successfully!', 'success');
    }

    // ===== CLOSE MODAL FUNCTION =====
    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
    }

    // ===== SHOW ADD NEW MODAL (GENERIC) =====
    function showAddNewModal() {
        switch(currentView) {
            case 'donations':
                showAddDonationModal();
                break;
            case 'volunteers':
                showAddVolunteerModal();
                break;
            case 'gallery':
                showAddGalleryModal();
                break;
            case 'news':
                showAddNewsModal();
                break;
            case 'users':
                showAddUserModal();
                break;
            default:
                showToast('Select a specific section to add items', 'info');
        }
    }

    // ===== VIEW RENDERERS =====
    function loadOverviewView() {
        const content = `
            <div class="stats-grid">
                <div class="stat-card" style="border-top-color: var(--primary);">
                    <div class="stat-header">
                        <h3>Total Donations</h3>
                        <div class="stat-icon">
                            <i class="fas fa-donate"></i>
                        </div>
                    </div>
                    <div class="stat-value">$${applicationData.stats.totalDonations.toLocaleString()}</div>
                    <div class="stat-label">This month</div>
                    <span class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        12.5% from last month
                    </span>
                </div>
                
                <div class="stat-card" style="border-top-color: var(--secondary);">
                    <div class="stat-header">
                        <h3>Active Volunteers</h3>
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="stat-value">${applicationData.stats.activeVolunteers}</div>
                    <div class="stat-label">Currently active</div>
                    <span class="stat-change positive">
                        <i class="fas fa-plus"></i>
                        8 new this week
                    </span>
                </div>
                
                <div class="stat-card" style="border-top-color: var(--warning);">
                    <div class="stat-header">
                        <h3>Ongoing Projects</h3>
                        <div class="stat-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                    <div class="stat-value">${applicationData.stats.ongoingProjects}</div>
                    <div class="stat-label">In progress</div>
                    <span class="stat-change positive">
                        <i class="fas fa-check"></i>
                        3 completed this month
                    </span>
                </div>
                
                <div class="stat-card" style="border-top-color: var(--accent);">
                    <div class="stat-header">
                        <h3>New Supporters</h3>
                        <div class="stat-icon">
                            <i class="fas fa-user-plus"></i>
                        </div>
                    </div>
                    <div class="stat-value">${applicationData.stats.newSupporters}</div>
                    <div class="stat-label">This week</div>
                    <span class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        24% increase
                    </span>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>Donation Trends</h3>
                <canvas id="donationChart" height="100"></canvas>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div class="chart-container">
                    <h3>Recent Activities</h3>
                    <div style="max-height: 300px; overflow-y: auto;">
                        ${applicationData.donations.slice(0, 5).map(donation => `
                            <div style="padding: 12px; border-bottom: 1px solid var(--light-gray); display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>${donation.donor}</strong>
                                    <div style="font-size: 0.9rem; color: var(--gray);">
                                        ${new Date(donation.date).toLocaleDateString()}
                                    </div>
                                </div>
                                <div>
                                    <strong style="color: var(--primary);">$${donation.amount}</strong>
                                    <span class="badge badge-${donation.status === 'completed' ? 'success' : 'warning'}" style="margin-left: 10px;">
                                        ${donation.status}
                                    </span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3>Quick Actions</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                        <button class="btn-primary" onclick="loadView('donations')" style="padding: 15px; text-align: left;">
                            <i class="fas fa-donate fa-2x" style="margin-bottom: 10px;"></i>
                            <div>Manage Donations</div>
                        </button>
                        <button class="btn-secondary" onclick="loadView('gallery')" style="padding: 15px; text-align: left;">
                            <i class="fas fa-images fa-2x" style="margin-bottom: 10px;"></i>
                            <div>Update Gallery</div>
                        </button>
                        <button class="btn-secondary" onclick="loadView('news')" style="padding: 15px; text-align: left;">
                            <i class="fas fa-newspaper fa-2x" style="margin-bottom: 10px;"></i>
                            <div>Post News</div>
                        </button>
                        <button class="btn-primary" onclick="syncToHomepage()" style="padding: 15px; text-align: left; background: var(--secondary);">
                            <i class="fas fa-sync-alt fa-2x" style="margin-bottom: 10px;"></i>
                            <div>Sync to Homepage</div>
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        document.getElementById('contentBody').innerHTML = content;
        
        // Initialize chart
        setTimeout(() => {
            const ctx = document.getElementById('donationChart')?.getContext('2d');
            if (ctx) {
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Donations ($)',
                            data: [12000, 19000, 15000, 25000, 22000, 30000],
                            borderColor: 'var(--primary)',
                            backgroundColor: 'rgba(26, 115, 232, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
        }, 100);
    }

    function loadDonationsView(forceRefresh = false) {
        if (forceRefresh) {
            loadDataFromStorage();
        }
        
        const content = `
            <div class="gallery-header">
                <h3 style="margin: 0;">Recent Donations (${applicationData.donations.length})</h3>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-secondary" onclick="exportDonations()">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn-primary" onclick="showAddDonationModal()">
                        <i class="fas fa-plus"></i> Add Donation
                    </button>
                </div>
            </div>
            
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Donor</th>
                            <th>Amount</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Method</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${applicationData.donations.map(donation => `
                            <tr>
                                <td>#${donation.id.toString().padStart(4, '0')}</td>
                                <td>${donation.donor}</td>
                                <td><strong style="color: var(--primary);">$${donation.amount}</strong></td>
                                <td>${new Date(donation.date).toLocaleDateString()}</td>
                                <td>
                                    <span class="badge badge-${donation.status === 'completed' ? 'success' : donation.status === 'pending' ? 'warning' : 'info'}">
                                        ${donation.status}
                                    </span>
                                </td>
                                <td>${donation.method}</td>
                                <td>
                                    <button class="btn-edit" onclick="editDonation(${donation.id})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-delete" onclick="deleteDonation(${donation.id})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
            
            <div class="chart-container">
                <h3>Donation Statistics</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <canvas id="donationMethodChart"></canvas>
                    </div>
                    <div>
                        <canvas id="donationStatusChart"></canvas>
                    </div>
                </div>
            </div>
        `;
        
        document.getElementById('contentBody').innerHTML = content;
        
        // Initialize charts
        setTimeout(() => {
            // Method Chart
            const methodCtx = document.getElementById('donationMethodChart')?.getContext('2d');
            if (methodCtx) {
                const methods = applicationData.donations.reduce((acc, donation) => {
                    acc[donation.method] = (acc[donation.method] || 0) + donation.amount;
                    return acc;
                }, {});
                
                new Chart(methodCtx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(methods),
                        datasets: [{
                            data: Object.values(methods),
                            backgroundColor: [
                                'var(--primary)',
                                'var(--secondary)',
                                'var(--warning)',
                                'var(--accent)'
                            ]
                        }]
                    }
                });
            }
            
            // Status Chart
            const statusCtx = document.getElementById('donationStatusChart')?.getContext('2d');
            if (statusCtx) {
                const statusCount = applicationData.donations.reduce((acc, donation) => {
                    acc[donation.status] = (acc[donation.status] || 0) + 1;
                    return acc;
                }, {});
                
                new Chart(statusCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(statusCount),
                        datasets: [{
                            label: 'Number of Donations',
                            data: Object.values(statusCount),
                            backgroundColor: 'var(--primary)'
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }, 100);
    }

    function loadGalleryView(forceRefresh = false) {
        if (forceRefresh) {
            loadDataFromStorage();
        }
        
        const content = `
            <div class="gallery-container">
                <div class="gallery-header">
                    <h3 style="margin: 0;">Gallery Images (${applicationData.gallery.length})</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-secondary" onclick="clearGallery()">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                        <button class="btn-primary" onclick="showAddGalleryModal()">
                            <i class="fas fa-plus"></i> Add Image
                        </button>
                    </div>
                </div>
                
                <div class="gallery-upload-area" onclick="showAddGalleryModal()">
                    <i class="fas fa-cloud-upload-alt fa-3x" style="color: var(--primary); margin-bottom: 15px;"></i>
                    <h4 style="color: var(--dark); margin-bottom: 10px;">Upload New Images</h4>
                    <p style="color: var(--gray); margin-bottom: 20px; font-size: 0.9rem;">
                        Click here or drag and drop images to upload
                    </p>
                    <button class="btn-secondary">
                        <i class="fas fa-images"></i> Browse Files
                    </button>
                </div>
                
                ${applicationData.gallery.length > 0 ? `
                    <div class="gallery-grid">
                        ${applicationData.gallery.map((image, index) => `
                            <div class="gallery-item" onclick="editGalleryItem(${index})">
                                <img src="${image.url}" alt="${image.title}" onerror="this.src='https://via.placeholder.com/150?text=Image+Error'">
                                <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 5px;">
                                    <button class="btn-edit" style="background: white; color: var(--primary); padding: 5px 8px;">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-delete" style="background: white; color: var(--accent); padding: 5px 8px;" onclick="event.stopPropagation(); deleteGalleryItem(${index})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                <div style="position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9rem;">
                                    <div style="font-weight: 500;">${image.title}</div>
                                    <div style="font-size: 0.8rem; opacity: 0.8;">${image.category || 'Uncategorized'}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : `
                    <div style="text-align: center; padding: 50px 20px;">
                        <i class="fas fa-images fa-4x" style="color: var(--light-gray); margin-bottom: 20px;"></i>
                        <h4 style="color: var(--gray); margin-bottom: 10px;">No Images Yet</h4>
                        <p style="color: var(--gray); margin-bottom: 20px;">Start by uploading images to your gallery</p>
                        <button class="btn-primary" onclick="showAddGalleryModal()">
                            <i class="fas fa-plus"></i> Add First Image
                        </button>
                    </div>
                `}
            </div>
            
            <div class="gallery-container">
                <h3>Gallery Statistics</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                    <div style="background: var(--light); padding: 20px; border-radius: var(--border-radius);">
                        <div style="font-size: 2rem; font-weight: 700; color: var(--primary);">${applicationData.gallery.length}</div>
                        <div style="color: var(--gray);">Total Images</div>
                    </div>
                    <div style="background: var(--light); padding: 20px; border-radius: var(--border-radius);">
                        <div style="font-size: 2rem; font-weight: 700; color: var(--secondary);">
                            ${new Set(applicationData.gallery.map(img => img.category)).size}
                        </div>
                        <div style="color: var(--gray);">Categories</div>
                    </div>
                    <div style="background: var(--light); padding: 20px; border-radius: var(--border-radius);">
                        <div style="font-size: 2rem; font-weight: 700; color: var(--warning);">
                            ${applicationData.gallery.filter(img => img.date && new Date(img.date) > new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)).length}
                        </div>
                        <div style="color: var(--gray);">Added This Week</div>
                    </div>
                </div>
            </div>
        `;
        
        document.getElementById('contentBody').innerHTML = content;
    }

    function loadNewsView(forceRefresh = false) {
        if (forceRefresh) {
            loadDataFromStorage();
        }
        
        const content = `
            <div class="gallery-header">
                <h3 style="margin: 0;">News Articles (${applicationData.news.length})</h3>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-secondary" onclick="exportNews()">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn-primary" onclick="showAddNewsModal()">
                        <i class="fas fa-plus"></i> Add News
                    </button>
                </div>
            </div>
            
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Title</th>
                            <th>Category</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Views</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${applicationData.news.map((article, index) => `
                            <tr>
                                <td>#${(index + 1).toString().padStart(3, '0')}</td>
                                <td style="max-width: 300px;">
                                    <div style="font-weight: 500;">${article.title}</div>
                                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 2px;">
                                        ${article.content.substring(0, 50)}...
                                    </div>
                                </td>
                                <td>
                                    <span class="badge badge-info">${article.category || 'General'}</span>
                                </td>
                                <td>${article.date || new Date().toLocaleDateString()}</td>
                                <td>
                                    <span class="badge badge-${article.published ? 'success' : 'warning'}">
                                        ${article.published ? 'Published' : 'Draft'}
                                    </span>
                                </td>
                                <td>${article.views || 0}</td>
                                <td>
                                    <button class="btn-edit" onclick="editNews(${index})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-delete" onclick="deleteNews(${index})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
            
            ${applicationData.news.length === 0 ? `
                <div style="text-align: center; padding: 50px 20px; background: white; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                    <i class="fas fa-newspaper fa-4x" style="color: var(--light-gray); margin-bottom: 20px;"></i>
                    <h4 style="color: var(--gray); margin-bottom: 10px;">No News Articles Yet</h4>
                    <p style="color: var(--gray); margin-bottom: 20px;">Start by creating your first news article</p>
                    <button class="btn-primary" onclick="showAddNewsModal()">
                        <i class="fas fa-plus"></i> Create First Article
                    </button>
                </div>
            ` : ''}
        `;
        
        document.getElementById('contentBody').innerHTML = content;
    }

    // ===== MODAL FUNCTIONS =====
    function showModal(modalId, title = '') {
        const modal = document.getElementById(modalId);
        if (title && modal.querySelector('h3')) {
            modal.querySelector('h3').textContent = title;
        }
        modal.classList.add('show');
        document.body.style.overflow = 'hidden';
    }

    function showProfileModal() {
        const content = `
            <div style="display: grid; gap: 20px;">
                <div style="display: flex; align-items: center; gap: 20px; padding: 20px; background: var(--light); border-radius: var(--border-radius);">
                    <img src="${document.getElementById('userAvatar').src}" alt="Admin" style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--primary);">
                    <div>
                        <h4 style="margin: 0; color: var(--dark);">${adminData.name}</h4>
                        <p style="margin: 5px 0; color: var(--gray);">${adminData.role}</p>
                        <p style="margin: 0; font-size: 0.9rem; color: var(--gray);">
                            <i class="fas fa-envelope"></i> ${adminData.email}
                        </p>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="background: var(--light); padding: 15px; border-radius: var(--border-radius);">
                        <div style="font-size: 0.9rem; color: var(--gray);">Username</div>
                        <div style="font-weight: 500; margin-top: 5px;">${adminData.username}</div>
                    </div>
                    <div style="background: var(--light); padding: 15px; border-radius: var(--border-radius);">
                        <div style="font-size: 0.9rem; color: var(--gray);">Last Login</div>
                        <div style="font-weight: 500; margin-top: 5px;">${new Date(adminData.lastLogin).toLocaleString()}</div>
                    </div>
                </div>
                
                <div>
                    <h4 style="margin-bottom: 15px; color: var(--dark);">Edit Profile</h4>
                    <div style="display: grid; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 0.9rem; color: var(--gray);">Display Name</label>
                            <input type="text" class="form-input" value="${adminData.name}" style="width: 100%;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 0.9rem; color: var(--gray);">Email Address</label>
                            <input type="email" class="form-input" value="${adminData.email}" style="width: 100%;">
                        </div>
                        <button class="btn-primary" onclick="updateProfile()">
                            <i class="fas fa-save"></i> Update Profile
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        document.getElementById('profileModalContent').innerHTML = content;
        showModal('profileModal');
    }

    function showAddGalleryModal() {
        const content = `
            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Image Title</label>
                    <input type="text" class="form-input" id="galleryTitle" placeholder="Enter image title" style="width: 100%;">
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Description</label>
                    <textarea class="form-input" id="galleryDescription" placeholder="Enter image description" rows="3" style="width: 100%; resize: vertical;"></textarea>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Category</label>
                    <select class="form-input" id="galleryCategory" style="width: 100%;">
                        <option value="donate">Donation</option>
                        <option value="about">About</option>
                        <option value="team">Team</option>
                        <option value="home">Home/Shelter</option>
                        <option value="stories">Stories</option>
                        <option value="relief">Relief Work</option>
                        <option value="rescue">Rescue Operations</option>
                        <option value="shelter">Shelter</option>
                    </select>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Image Upload</label>
                    <div class="gallery-upload-area" onclick="document.getElementById('galleryFileInput').click()" style="cursor: pointer; text-align: center;">
                        <i class="fas fa-cloud-upload-alt fa-2x" style="color: var(--primary); margin-bottom: 10px;"></i>
                        <p style="color: var(--gray); margin: 0;">Click to upload image or drag and drop</p>
                        <p style="color: var(--gray); font-size: 0.9rem; margin-top: 5px;">PNG, JPG, GIF up to 5MB</p>
                    </div>
                    <input type="file" id="galleryFileInput" accept="image/*" style="display: none;" onchange="previewGalleryImage(this)">
                    <div id="imagePreviewContainer" class="image-preview-container"></div>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Uploaded By</label>
                    <input type="text" class="form-input" id="galleryUploader" value="${adminData.name}" style="width: 100%;">
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-secondary" onclick="closeModal('galleryModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="saveGalleryItem()">
                        <i class="fas fa-save"></i> Save Image
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('galleryModalContent').innerHTML = content;
        document.getElementById('galleryModalTitle').textContent = 'Add Gallery Image';
        showModal('galleryModal');
    }

    function showAddNewsModal() {
        const content = `
            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">News Title</label>
                    <input type="text" class="form-input" id="newsTitle" placeholder="Enter news title" style="width: 100%;">
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Category</label>
                    <select class="form-input" id="newsCategory" style="width: 100%;">
                        <option value="urgent">Urgent</option>
                        <option value="update">Update</option>
                        <option value="story">Success Story</option>
                        <option value="event">Event</option>
                        <option value="general">General</option>
                    </select>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Content</label>
                    <div class="editor-toolbar">
                        <button type="button" onclick="formatText('bold')"><i class="fas fa-bold"></i></button>
                        <button type="button" onclick="formatText('italic')"><i class="fas fa-italic"></i></button>
                        <button type="button" onclick="formatText('underline')"><i class="fas fa-underline"></i></button>
                        <button type="button" onclick="formatText('insertUnorderedList')"><i class="fas fa-list-ul"></i></button>
                        <button type="button" onclick="formatText('insertOrderedList')"><i class="fas fa-list-ol"></i></button>
                    </div>
                    <div class="editor-content" id="newsContent" contenteditable="true" placeholder="Enter news content here..."></div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Publish Date</label>
                        <input type="date" class="form-input" id="newsDate" style="width: 100%;" value="${new Date().toISOString().split('T')[0]}">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Status</label>
                        <select class="form-input" id="newsStatus" style="width: 100%;">
                            <option value="draft">Draft</option>
                            <option value="published">Published</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-secondary" onclick="closeModal('newsModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="saveNewsArticle()">
                        <i class="fas fa-save"></i> Save Article
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('newsModalContent').innerHTML = content;
        document.getElementById('newsModalTitle').textContent = 'Add News Article';
        showModal('newsModal');
    }

    function showNotificationsModal() {
        const unreadCount = applicationData.notifications.filter(n => !n.read).length;
        const content = `
            <div style="max-height: 400px; overflow-y: auto;">
                ${applicationData.notifications.map(notification => `
                    <div class="notification-item ${!notification.read ? 'unread' : ''}" onclick="markNotificationRead(${notification.id})">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <strong style="color: var(--dark);">${notification.title}</strong>
                            <span style="font-size: 0.8rem; color: var(--gray);">${notification.time}</span>
                        </div>
                        <div style="color: var(--gray); font-size: 0.9rem;">${notification.message}</div>
                    </div>
                `).join('')}
                
                ${applicationData.notifications.length === 0 ? `
                    <div style="text-align: center; padding: 40px 20px; color: var(--gray);">
                        <i class="fas fa-bell-slash fa-2x" style="margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>No notifications yet</p>
                    </div>
                ` : ''}
            </div>
            
            ${unreadCount > 0 ? `
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--light-gray);">
                    <button class="btn-secondary" onclick="markAllNotificationsRead()" style="width: 100%;">
                        <i class="fas fa-check-circle"></i> Mark All as Read
                    </button>
                </div>
            ` : ''}
        `;
        
        document.getElementById('notificationModalContent').innerHTML = content;
        showModal('notificationModal');
    }

    // ===== GALLERY FUNCTIONS =====
    function previewGalleryImage(input) {
        const previewContainer = document.getElementById('imagePreviewContainer');
        previewContainer.innerHTML = '';
        
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                previewContainer.innerHTML = `
                    <div class="image-preview">
                        <img src="${e.target.result}" alt="Preview">
                        <button class="image-preview-remove" onclick="clearImagePreview()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function clearImagePreview() {
        const previewContainer = document.getElementById('imagePreviewContainer');
        const fileInput = document.getElementById('galleryFileInput');
        
        previewContainer.innerHTML = '';
        fileInput.value = '';
    }

    function saveGalleryItem() {
        const title = document.getElementById('galleryTitle').value.trim();
        const description = document.getElementById('galleryDescription').value.trim();
        const category = document.getElementById('galleryCategory').value;
        const uploadedBy = document.getElementById('galleryUploader').value.trim();
        const fileInput = document.getElementById('galleryFileInput');
        
        if (!title) {
            showToast('Please enter image title', 'error');
            return;
        }
        
        if (!fileInput.files || !fileInput.files[0]) {
            showToast('Please select an image to upload', 'error');
            return;
        }
        
        // Read image as data URL
        const reader = new FileReader();
        reader.onload = function(e) {
            const newImage = {
                id: Date.now(),
                title: title,
                description: description,
                category: category,
                date: new Date().toISOString().split('T')[0],
                uploadedBy: uploadedBy || adminData.name,
                url: e.target.result,
                timestamp: new Date().toISOString()
            };
            
            // Add to gallery
            applicationData.gallery.unshift(newImage);
            
            // Save to localStorage
            localStorage.setItem('flood_relief_gallery', JSON.stringify(applicationData.gallery));
            
            // Update stats
            applicationData.stats.galleryImages = applicationData.gallery.length;
            updateStats();
            
            showToast('Image added to gallery successfully!', 'success');
            
            // Refresh gallery view
            loadGalleryView(true);
            
            // Close modal
            closeModal('galleryModal');
        };
        
        reader.readAsDataURL(fileInput.files[0]);
    }

    function editGalleryItem(index) {
        const image = applicationData.gallery[index];
        
        const content = `
            <div style="display: grid; gap: 20px;">
                <div style="display: flex; gap: 20px;">
                    <div style="flex: 1;">
                        <img src="${image.url}" alt="${image.title}" style="width: 100%; border-radius: var(--border-radius);">
                    </div>
                    <div style="flex: 2;">
                        <h4 style="margin-top: 0; color: var(--dark);">${image.title}</h4>
                        <p style="color: var(--gray);">${image.description}</p>
                        <div style="margin-top: 15px;">
                            <div style="display: grid; grid-template-columns: auto 1fr; gap: 10px;">
                                <div style="font-weight: 500; color: var(--dark);">Category:</div>
                                <div>${image.category}</div>
                                <div style="font-weight: 500; color: var(--dark);">Uploaded by:</div>
                                <div>${image.uploadedBy}</div>
                                <div style="font-weight: 500; color: var(--dark);">Date:</div>
                                <div>${image.date}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 style="margin-bottom: 15px; color: var(--dark);">Edit Image Details</h4>
                    <div style="display: grid; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 0.9rem; color: var(--gray);">Title</label>
                            <input type="text" class="form-input" value="${image.title}" id="editGalleryTitle" style="width: 100%;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 0.9rem; color: var(--gray);">Description</label>
                            <textarea class="form-input" id="editGalleryDescription" style="width: 100%; resize: vertical; min-height: 100px;">${image.description}</textarea>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 0.9rem; color: var(--gray);">Category</label>
                            <select class="form-input" id="editGalleryCategory" style="width: 100%;">
                                <option value="donate" ${image.category === 'donate' ? 'selected' : ''}>Donation</option>
                                <option value="about" ${image.category === 'about' ? 'selected' : ''}>About</option>
                                <option value="team" ${image.category === 'team' ? 'selected' : ''}>Team</option>
                                <option value="home" ${image.category === 'home' ? 'selected' : ''}>Home/Shelter</option>
                                <option value="stories" ${image.category === 'stories' ? 'selected' : ''}>Stories</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-delete" onclick="deleteGalleryItem(${index}); closeModal('galleryModal');">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                    <button class="btn-secondary" onclick="closeModal('galleryModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="updateGalleryItem(${index})">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('galleryModalContent').innerHTML = content;
        document.getElementById('galleryModalTitle').textContent = 'Edit Gallery Image';
        showModal('galleryModal');
    }

    function updateGalleryItem(index) {
        const title = document.getElementById('editGalleryTitle').value.trim();
        const description = document.getElementById('editGalleryDescription').value.trim();
        const category = document.getElementById('editGalleryCategory').value;
        
        if (!title) {
            showToast('Please enter image title', 'error');
            return;
        }
        
        // Update image
        applicationData.gallery[index].title = title;
        applicationData.gallery[index].description = description;
        applicationData.gallery[index].category = category;
        
        // Save to localStorage
        localStorage.setItem('flood_relief_gallery', JSON.stringify(applicationData.gallery));
        
        showToast('Image updated successfully!', 'success');
        closeModal('galleryModal');
        loadGalleryView(true);
    }

    function deleteGalleryItem(index) {
        if (confirm('Are you sure you want to delete this image?')) {
            applicationData.gallery.splice(index, 1);
            
            // Save to localStorage
            localStorage.setItem('flood_relief_gallery', JSON.stringify(applicationData.gallery));
            
            // Update stats
            applicationData.stats.galleryImages = applicationData.gallery.length;
            updateStats();
            
            showToast('Image deleted successfully', 'success');
            loadGalleryView(true);
        }
    }

    function clearGallery() {
        if (applicationData.gallery.length === 0) {
            showToast('Gallery is already empty', 'info');
            return;
        }
        
        if (confirm(`Are you sure you want to delete all ${applicationData.gallery.length} images? This action cannot be undone.`)) {
            applicationData.gallery = [];
            
            // Save to localStorage
            localStorage.setItem('flood_relief_gallery', JSON.stringify([]));
            
            // Update stats
            applicationData.stats.galleryImages = 0;
            updateStats();
            
            showToast('Gallery cleared successfully', 'success');
            loadGalleryView(true);
        }
    }

    // ===== NEWS FUNCTIONS =====
    function formatText(command) {
        document.execCommand(command, false, null);
    }

    function saveNewsArticle() {
        const title = document.getElementById('newsTitle').value.trim();
        const category = document.getElementById('newsCategory').value;
        const content = document.getElementById('newsContent').innerHTML;
        const date = document.getElementById('newsDate').value;
        const status = document.getElementById('newsStatus').value;
        
        if (!title) {
            showToast('Please enter news title', 'error');
            return;
        }
        
        if (!content || content === '<br>') {
            showToast('Please enter news content', 'error');
            return;
        }
        
        const newArticle = {
            id: Date.now(),
            title: title,
            category: category,
            content: content,
            date: date,
            published: status === 'published',
            author: adminData.name,
            views: 0,
            timestamp: new Date().toISOString()
        };
        
        // Add to news
        applicationData.news.unshift(newArticle);
        
        // Save to localStorage
        localStorage.setItem('flood_relief_news', JSON.stringify(applicationData.news));
        
        // Update stats
        applicationData.stats.newsArticles = applicationData.news.length;
        updateStats();
        
        showToast('News article saved successfully!', 'success');
        
        // Refresh news view
        loadNewsView(true);
        
        // Close modal
        closeModal('newsModal');
    }

    function editNews(index) {
        const article = applicationData.news[index];
        
        const content = `
            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">News Title</label>
                    <input type="text" class="form-input" id="editNewsTitle" value="${article.title}" style="width: 100%;">
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Category</label>
                    <select class="form-input" id="editNewsCategory" style="width: 100%;">
                        <option value="urgent" ${article.category === 'urgent' ? 'selected' : ''}>Urgent</option>
                        <option value="update" ${article.category === 'update' ? 'selected' : ''}>Update</option>
                        <option value="story" ${article.category === 'story' ? 'selected' : ''}>Success Story</option>
                        <option value="event" ${article.category === 'event' ? 'selected' : ''}>Event</option>
                        <option value="general" ${article.category === 'general' ? 'selected' : ''}>General</option>
                    </select>
                </div>
                
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Content</label>
                    <div class="editor-toolbar">
                        <button type="button" onclick="formatText('bold')"><i class="fas fa-bold"></i></button>
                        <button type="button" onclick="formatText('italic')"><i class="fas fa-italic"></i></button>
                        <button type="button" onclick="formatText('underline')"><i class="fas fa-underline"></i></button>
                        <button type="button" onclick="formatText('insertUnorderedList')"><i class="fas fa-list-ul"></i></button>
                        <button type="button" onclick="formatText('insertOrderedList')"><i class="fas fa-list-ol"></i></button>
                    </div>
                    <div class="editor-content" id="editNewsContent" contenteditable="true">${article.content}</div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Publish Date</label>
                        <input type="date" class="form-input" id="editNewsDate" style="width: 100%;" value="${article.date}">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark);">Status</label>
                        <select class="form-input" id="editNewsStatus" style="width: 100%;">
                            <option value="draft" ${!article.published ? 'selected' : ''}>Draft</option>
                            <option value="published" ${article.published ? 'selected' : ''}>Published</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn-delete" onclick="deleteNews(${index}); closeModal('newsModal');">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                    <button class="btn-secondary" onclick="closeModal('newsModal')">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="updateNewsArticle(${index})">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('newsModalContent').innerHTML = content;
        document.getElementById('newsModalTitle').textContent = 'Edit News Article';
        showModal('newsModal');
    }

    function updateNewsArticle(index) {
        const title = document.getElementById('editNewsTitle').value.trim();
        const category = document.getElementById('editNewsCategory').value;
        const content = document.getElementById('editNewsContent').innerHTML;
        const date = document.getElementById('editNewsDate').value;
        const status = document.getElementById('editNewsStatus').value;
        
        if (!title) {
            showToast('Please enter news title', 'error');
            return;
        }
        
        if (!content || content === '<br>') {
            showToast('Please enter news content', 'error');
            return;
        }
        
        // Update article
        applicationData.news[index].title = title;
        applicationData.news[index].category = category;
        applicationData.news[index].content = content;
        applicationData.news[index].date = date;
        applicationData.news[index].published = status === 'published';
        
        // Save to localStorage
        localStorage.setItem('flood_relief_news', JSON.stringify(applicationData.news));
        
        showToast('News article updated successfully!', 'success');
        closeModal('newsModal');
        loadNewsView(true);
    }

    function deleteNews(index) {
        if (confirm('Are you sure you want to delete this news article?')) {
            applicationData.news.splice(index, 1);
            
            // Save to localStorage
            localStorage.setItem('flood_relief_news', JSON.stringify(applicationData.news));
            
            // Update stats
            applicationData.stats.newsArticles = applicationData.news.length;
            updateStats();
            
            showToast('News article deleted successfully', 'success');
            loadNewsView(true);
        }
    }

    function exportNews() {
        const dataStr = JSON.stringify(applicationData.news, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
        
        const exportFileDefaultName = `news_export_${new Date().toISOString().split('T')[0]}.json`;
        
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();
        
        showToast('News exported successfully!', 'success');
    }

    // ===== SYNC FUNCTIONS =====
   function syncToHomepage() {
    showToast('Syncing data to homepage...', 'info');
    
    // Get current timestamp
    const timestamp = new Date().toISOString();
    
    // Update all localStorage data with current timestamp
    const updateData = {
        gallery: applicationData.gallery,
        news: applicationData.news,
        donations: applicationData.donations,
        stats: applicationData.stats,
        lastUpdated: timestamp
    };
    
    // Save each to localStorage
    localStorage.setItem('flood_relief_gallery', JSON.stringify(updateData.gallery));
    localStorage.setItem('flood_relief_news', JSON.stringify(updateData.news));
    localStorage.setItem('flood_relief_donations', JSON.stringify(updateData.donations));
    localStorage.setItem('flood_relief_stats', JSON.stringify(updateData.stats));
    
    // Set update timestamp
    localStorage.setItem('last_dashboard_update', timestamp);
    
    // Trigger force refresh
    localStorage.setItem('force_homepage_refresh', timestamp);
    
    // Dispatch storage event to trigger refresh on homepage
    window.dispatchEvent(new StorageEvent('storage', {
        key: 'force_homepage_refresh',
        newValue: timestamp,
        oldValue: null,
        url: window.location.href,
        storageArea: localStorage
    }));
    
    // Also dispatch individual events for each data type
    ['gallery', 'news', 'donations', 'stats'].forEach(type => {
        window.dispatchEvent(new StorageEvent('storage', {
            key: `flood_relief_${type}`,
            newValue: JSON.stringify(updateData[type]),
            oldValue: null,
            url: window.location.href,
            storageArea: localStorage
        }));
    });
    
    // Update notification
    addNotification('sync', 'Data Sync Complete', 'All data has been synchronized to the homepage');
    
    setTimeout(() => {
        showToast('All data synced successfully! Homepage will refresh automatically.', 'success');
    }, 1000);
};

    function updateStats() {
        localStorage.setItem('flood_relief_stats', JSON.stringify(applicationData.stats));
    }

    // ===== NOTIFICATION FUNCTIONS =====
    function updateNotificationCount() {
        const unreadCount = applicationData.notifications.filter(n => !n.read).length;
        document.getElementById('notificationCount').textContent = unreadCount;
    }

    function addNotification(type, title, message) {
        const newNotification = {
            id: Date.now(),
            type: type,
            title: title,
            message: message,
            time: 'Just now',
            read: false
        };
        
        applicationData.notifications.unshift(newNotification);
        updateNotificationCount();
    }

    function markNotificationRead(id) {
        const notification = applicationData.notifications.find(n => n.id === id);
        if (notification) {
            notification.read = true;
            updateNotificationCount();
        }
    }

    function markAllNotificationsRead() {
        applicationData.notifications.forEach(n => n.read = true);
        updateNotificationCount();
        closeModal('notificationModal');
        showToast('All notifications marked as read', 'success');
    }

    function startNotificationPolling() {
        // Simulate receiving notifications
        setInterval(() => {
            if (Math.random() > 0.7) { // 30% chance of new notification
                const notificationTypes = ['donation', 'volunteer', 'system'];
                const type = notificationTypes[Math.floor(Math.random() * notificationTypes.length)];
                
                let title, message;
                switch(type) {
                    case 'donation':
                        title = 'New Donation Received';
                        message = `New donation of $${Math.floor(Math.random() * 1000) + 100} received`;
                        break;
                    case 'volunteer':
                        title = 'New Volunteer Registration';
                        message = 'New volunteer has registered and is pending approval';
                        break;
                    case 'system':
                        title = 'System Alert';
                        message = 'Performance metrics are optimal';
                        break;
                }
                
                addNotification(type, title, message);
            }
        }, 30000); // Check every 30 seconds
    }

    // ===== UTILITY FUNCTIONS =====
    function showToast(message, type = 'info') {
        const toast = document.getElementById('toast');
        const toastIcon = document.getElementById('toastIcon');
        const toastMessage = document.getElementById('toastMessage');
        
        // Set content
        toastMessage.textContent = message;
        
        // Set icon and color based on type
        const icons = {
            success: 'fas fa-check-circle',
            error: 'fas fa-exclamation-circle',
            warning: 'fas fa-exclamation-triangle',
            info: 'fas fa-info-circle'
        };
        
        toastIcon.className = icons[type] || icons.info;
        toast.className = `toast ${type}`;
        
        // Show toast
        toast.classList.add('show');
        
        // Auto hide after 5 seconds
        setTimeout(() => {
            toast.classList.remove('show');
        }, 5000);
    }

    function logout() {
        // Clear session
        localStorage.removeItem('admin_logged_in');
        localStorage.removeItem('admin_username');
        localStorage.removeItem('admin_role');
        localStorage.removeItem('admin_name');
        localStorage.removeItem('admin_email');
        
        // Show login screen
        document.getElementById('dashboardMain').style.display = 'none';
        document.getElementById('loginScreen').style.display = 'flex';
        
        // Reset form
        document.getElementById('loginForm').reset();
        
        showToast('Logged out successfully', 'success');
    }

    function updateProfile() {
        const nameInput = document.querySelector('#profileModalContent input[type="text"]');
        const emailInput = document.querySelector('#profileModalContent input[type="email"]');
        
        const newName = nameInput.value.trim();
        const newEmail = emailInput.value.trim();
        
        if (!newName || !newEmail) {
            showToast('Please fill in all fields', 'error');
            return;
        }
        
        // Update admin data
        adminData.name = newName;
        adminData.email = newEmail;
        
        // Update localStorage
        localStorage.setItem('admin_name', newName);
        localStorage.setItem('admin_email', newEmail);
        
        // Update display
        document.getElementById('userDisplayName').textContent = newName;
        
        // Update avatar with new name
        const colors = {
            'Super Admin': '1a73e8',
            'Administrator': '0d47a1',
            'Manager': '673ab7',
            'Coordinator': 'ff9800',
            'Staff': '34a853'
        };
        
        const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(newName)}&background=${colors[adminData.role] || '1a73e8'}&color=fff&bold=true`;
        document.getElementById('userAvatar').src = avatarUrl;
        
        showToast('Profile updated successfully', 'success');
        closeModal('profileModal');
    }

    // ===== ADDITIONAL VIEWS =====
    function loadAnalyticsView() {
        const content = `
            <div style="text-align: center; padding: 50px 20px;">
                <i class="fas fa-chart-bar fa-4x" style="color: var(--primary); margin-bottom: 20px;"></i>
                <h3 style="color: var(--dark); margin-bottom: 10px;">Analytics & Reports</h3>
                <p style="color: var(--gray); max-width: 600px; margin: 0 auto 30px;">
                    Detailed analytics, reports, and insights about your relief efforts.
                </p>
                <button class="btn-primary" onclick="showToast('Analytics dashboard coming soon!', 'info')">
                    <i class="fas fa-download"></i> Generate Report
                </button>
            </div>
        `;
        document.getElementById('contentBody').innerHTML = content;
    }

    function loadSettingsView() {
        const content = `
            <div style="max-width: 800px; margin: 0 auto;">
                <h3 style="color: var(--dark); margin-bottom: 30px;">System Settings</h3>
                
                <div style="display: grid; gap: 30px;">
                    <div class="gallery-container">
                        <h4 style="margin-bottom: 20px; color: var(--dark);">General Settings</h4>
                        <div style="display: grid; gap: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 500; color: var(--dark);">Email Notifications</div>
                                    <div style="font-size: 0.9rem; color: var(--gray);">Receive email alerts for new donations</div>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 500; color: var(--dark);">Auto-refresh Dashboard</div>
                                    <div style="font-size: 0.9rem; color: var(--gray);">Automatically refresh dashboard data</div>
                                </div>
                                <label class="switch">
                                    <input type="checkbox">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="gallery-container">
                        <h4 style="margin-bottom: 20px; color: var(--dark);">Data Management</h4>
                        <div style="display: grid; gap: 15px;">
                            <button class="btn-secondary" onclick="backupData()">
                                <i class="fas fa-database"></i> Backup All Data
                            </button>
                            <button class="btn-secondary" onclick="resetData()">
                                <i class="fas fa-redo"></i> Reset Demo Data
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        document.getElementById('contentBody').innerHTML = content;
    }

    function loadReportsView() {
        const content = `
            <div style="text-align: center; padding: 50px 20px;">
                <i class="fas fa-file-alt fa-4x" style="color: var(--primary); margin-bottom: 20px;"></i>
                <h3 style="color: var(--dark); margin-bottom: 10px;">Reports</h3>
                <p style="color: var(--gray); max-width: 600px; margin: 0 auto 30px;">
                    Generate detailed reports on donations, volunteers, and relief operations.
                </p>
                <button class="btn-primary" onclick="showToast('Report generation coming soon!', 'info')">
                    <i class="fas fa-file-export"></i> Export Report
                </button>
            </div>
        `;
        document.getElementById('contentBody').innerHTML = content;
    }

    // ===== UTILITY FUNCTIONS =====
    function backupData() {
        const backup = {
            gallery: applicationData.gallery,
            news: applicationData.news,
            donations: applicationData.donations,
            stats: applicationData.stats,
            timestamp: new Date().toISOString()
        };
        
        const dataStr = JSON.stringify(backup, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
        
        const exportFileDefaultName = `flood_relief_backup_${new Date().toISOString().split('T')[0]}.json`;
        
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();
        
        showToast('Data backup created successfully!', 'success');
    }

    function resetData() {
        if (confirm('Are you sure you want to reset all demo data? This action cannot be undone.')) {
            // Reset to default demo data
            applicationData = {
                stats: {
                    totalDonations: 12450,
                    activeVolunteers: 48,
                    ongoingProjects: 7,
                    newSupporters: 127,
                    pendingApprovals: 12,
                    recentDonations: 8500,
                    newsArticles: 24,
                    galleryImages: 15
                },
                donations: [
                    { id: 1, donor: 'John Smith', amount: 500, date: '2024-03-20', status: 'completed', method: 'Credit Card' },
                    { id: 2, donor: 'Emma Wilson', amount: 250, date: '2024-03-19', status: 'completed', method: 'PayPal' },
                    { id: 3, donor: 'Michael Brown', amount: 1000, date: '2024-03-19', status: 'pending', method: 'Bank Transfer' },
                    { id: 4, donor: 'Sarah Johnson', amount: 75, date: '2024-03-18', status: 'completed', method: 'Credit Card' },
                    { id: 5, donor: 'David Lee', amount: 300, date: '2024-03-18', status: 'completed', method: 'PayPal' }
                ],
                volunteers: [
                    { id: 1, name: 'Alex Turner', email: 'alex@example.com', phone: '+1 234 567 8901', status: 'active', hours: 48 },
                    { id: 2, name: 'Maria Garcia', email: 'maria@example.com', phone: '+1 234 567 8902', status: 'active', hours: 36 },
                    { id: 3, name: 'James Wilson', email: 'james@example.com', phone: '+1 234 567 8903', status: 'pending', hours: 0 },
                    { id: 4, name: 'Lisa Chen', email: 'lisa@example.com', phone: '+1 234 567 8904', status: 'active', hours: 24 },
                    { id: 5, name: 'Robert Kim', email: 'robert@example.com', phone: '+1 234 567 8905', status: 'inactive', hours: 12 }
                ],
                gallery: [],
                news: [],
                users: [],
                notifications: [
                    { id: 1, type: 'donation', title: 'New Donation Received', message: 'John Smith donated $500', time: '10:30 AM', read: false },
                    { id: 2, type: 'volunteer', title: 'Volunteer Application', message: 'New volunteer application pending review', time: 'Yesterday', read: false },
                    { id: 3, type: 'system', title: 'System Update', message: 'Scheduled maintenance tonight at 2 AM', time: '2 days ago', read: true }
                ]
            };
            
            // Clear localStorage
            localStorage.removeItem('flood_relief_gallery');
            localStorage.removeItem('flood_relief_news');
            localStorage.removeItem('flood_relief_donations');
            localStorage.removeItem('flood_relief_stats');
            localStorage.removeItem('flood_relief_volunteers');
            localStorage.removeItem('flood_relief_users');
            
            // Reload current view
            loadView(currentView, true);
            
            showToast('Demo data has been reset', 'success');
        }
    }

    // ===== DASHBOARD REFRESH INTERVAL =====
    setInterval(() => {
        // Update live stats
        applicationData.stats.recentDonations += Math.floor(Math.random() * 100);
        applicationData.stats.newSupporters += Math.floor(Math.random() * 5);
        
        // Update stats in localStorage
        localStorage.setItem('flood_relief_stats', JSON.stringify(applicationData.stats));
        
        // Refresh current view if it's overview
        if (currentView === 'overview') {
            loadView('overview', true);
        }
    }, 30000); // Update every 30 seconds
</script>
</body>
</html>